{
  "hash": "ec0ad3eea27f3c7730415de7ddade5d4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"STA237: Probability, Statistics and Data Analysis I\"\nimage: dice.png\ncategories: [Probability, R, Simulations]\ndescription: 'Notes for STA237 Summer 2025'\ntoc-depth: 1\n---\n\n\n\nAcknowledgements: This page contains tutorial notes for [STA237H1 Probability, Statistics and Data Analysis I](https://artsci.calendar.utoronto.ca/course/sta237h1) Summer 2025 under the instruction of [Dr. Gracia Yunruo Dong](https://graciadong.github.io/).\n\nThe notes are completed as of June 13, 2026. If you have any feedback based on your experience over the course of this semester, please share it using [this link](https://docs.google.com/forms/d/e/1FAIpQLSdxa5pBOhz2qPJXdqHNaIE6RcbXY8KylWueBeOSSwk_7BEIIg/viewform?usp=header), which contains 8 short questions. Your input would be greatly appreciated—thank you!\n\n# Week 1\n\n::: {.callout-question collapse=\"true\"}\n### Question 1\n\n**b)** Suppose $\\Omega = \\{1, 2, 3, 4, 5, 6\\}$ and let $A = \\{1, 2, 4, 5\\}$, $B = \\{1, 3, 5\\}$ and $C = \\{2, 4, 6\\}$. Use this example to verify the two results in the distributive law.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nWe need to verify two things.\n\ni.  $A \\cap (B \\cup C) = (A \\cap B) \\cup (A \\cap C)$\n\n\\begin{align*}\nB \\cup C &=  \\{1, 2, 3, 4, 5, 6\\} \\\\\nA \\cap (B \\cup C) &=  \\{1, 2, 4, 5\\} \\\\\nA \\cap B &=  \\{1, 5\\} \\\\\nA \\cap C &=  \\{2, 4\\} \\\\\n(A \\cap B) \\cup (A \\cap C) &=  \\{1, 2, 4, 5\\}\n\\end{align*}\n\nTherefore, $A \\cap (B \\cup C) = (A \\cap B) \\cup (A \\cap C)$ as required.\n\n\\bigskip\n\nii. $A \\cup (B \\cap C) = (A \\cup B) \\cap (A \\cup C)$\n\n\\begin{align*}\nB \\cap C &= \\{1, 3, 5\\} \\cap \\{2, 4, 6\\} = \\emptyset \\\\\nA \\cup (B \\cap C) &=  \\{1, 2, 4, 5\\} \\\\\nA \\cup B &=  \\{1, 2, 3, 4, 5\\} \\\\\nA \\cup C &=  \\{1, 2, 4, 5, 6\\} \\\\\n(A \\cup B) \\cap (A \\cup C) &= \\{1, 2, 4, 5\\}\n\\end{align*}\n\nTherefore, $A \\cup (B \\cap C) = (A \\cup B) \\cap (A \\cup C)$ as required.\n:::\n\n::: {.callout-question collapsed=\"true\"}\n### Question 2\n\nIn R, write R code to simulate rolling a fair six-sided die once, 10 times, 100 times, and 1000 times.\n\n**a)** Estimate the probability of rolling a 3 or higher based on 1000 simulated dice rolls.\n\n**b)** If you were to repeat your simulation, would you end up with the same estimate? Why or why not.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nWe first simulate the rolling of a fair six-sided die 10, 100, and 1000 times.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025) # set seed for reproducibility\nsample(1:6, 10, replace=TRUE)  # Rolling a fair six-sided die 10 times\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 5 4 4 2 1 6 3 2 5 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsample(1:6, 100, replace=TRUE) # 100 times\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] 4 4 3 3 5 3 3 6 5 5 1 4 1 6 3 6 4 3 2 3 5 3 5 4 2 2 1 3 2 2 1 3 3 1 6 4 4\n [38] 2 5 3 3 1 3 6 2 1 1 1 6 2 4 1 5 2 5 5 6 3 1 6 4 4 6 5 3 4 2 2 2 5 2 1 1 5\n [75] 4 6 3 6 4 4 1 4 5 4 4 6 2 5 1 6 4 5 4 6 2 4 4 6 3 5\n```\n\n\n:::\n\n```{.r .cell-code}\nsample(1:6, 1000, replace=TRUE) # 1000 times\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   [1] 2 1 2 6 3 2 4 6 5 1 2 6 2 2 1 2 1 6 4 4 1 6 3 6 2 3 2 4 1 1 6 1 1 2 6 5 2\n  [38] 3 5 4 5 4 6 4 4 4 5 2 4 6 4 6 5 3 4 5 4 1 3 3 2 4 4 6 4 3 3 2 6 1 1 2 4 6\n  [75] 4 4 2 6 6 4 3 3 2 3 6 3 6 1 6 1 3 2 4 1 6 5 3 6 2 2 5 6 4 4 3 4 1 3 3 2 4\n [112] 3 4 5 5 4 5 2 1 3 1 5 2 3 5 6 5 4 1 4 5 4 3 2 6 1 2 5 6 2 5 3 1 6 4 3 2 5\n [149] 4 5 2 4 4 2 6 2 6 4 2 2 3 1 6 3 1 3 3 6 4 1 6 2 1 3 6 3 4 1 3 3 6 1 5 6 1\n [186] 1 2 2 1 1 2 1 6 4 6 2 4 4 3 1 1 3 5 1 5 2 3 3 6 5 4 2 6 5 5 6 3 1 3 1 1 3\n [223] 1 5 4 5 6 2 1 3 1 6 3 3 3 6 2 4 5 5 3 4 1 3 6 1 1 1 4 4 5 1 4 2 5 4 6 3 4\n [260] 3 4 4 4 1 6 3 4 6 5 1 5 4 4 3 5 3 6 1 6 6 5 3 1 5 3 2 1 2 2 6 1 3 5 1 3 6\n [297] 1 5 4 5 5 2 4 6 4 1 3 1 6 2 3 1 4 4 5 6 5 1 4 2 1 1 4 4 3 3 1 2 1 4 6 4 3\n [334] 5 4 2 2 5 3 5 3 6 5 3 6 3 3 2 3 6 1 4 4 1 3 6 6 5 6 5 3 2 2 3 4 2 3 6 5 1\n [371] 2 3 2 2 5 4 6 4 3 1 2 2 5 2 4 6 6 4 6 1 2 4 1 2 1 4 6 3 3 2 3 6 1 1 3 3 3\n [408] 2 4 3 1 6 1 1 2 4 3 1 2 4 4 5 3 3 2 5 1 5 6 4 4 6 5 1 1 6 6 1 3 6 1 5 5 4\n [445] 2 6 5 6 1 2 6 5 1 6 2 2 6 1 5 3 5 4 6 2 1 4 6 2 6 5 3 4 6 6 4 4 3 4 6 6 2\n [482] 3 6 1 1 1 4 2 4 3 2 2 4 2 2 6 2 3 6 5 6 4 4 6 6 3 5 6 3 5 4 6 2 4 4 6 1 4\n [519] 3 5 1 1 6 4 1 5 1 4 5 2 2 6 2 2 4 4 1 5 4 1 4 1 5 3 4 6 2 1 5 1 5 3 4 6 1\n [556] 6 4 2 1 4 3 4 1 3 6 1 3 2 6 2 3 1 1 5 6 6 1 1 2 4 5 5 2 2 5 4 6 1 6 5 6 5\n [593] 4 4 4 5 6 1 3 1 5 5 3 4 1 3 2 4 2 5 4 6 5 6 6 1 3 3 4 3 6 6 6 3 1 2 2 6 2\n [630] 3 1 4 6 1 2 4 3 5 1 4 3 6 5 4 5 3 3 6 6 1 6 3 1 3 1 4 1 5 6 5 4 4 4 6 5 6\n [667] 4 3 2 2 3 6 1 1 6 5 3 3 3 2 5 5 5 1 4 4 4 4 6 2 5 1 4 1 5 6 4 3 6 3 1 4 3\n [704] 4 1 3 6 3 6 6 2 6 4 2 5 4 1 4 3 4 3 1 2 3 3 6 5 3 6 2 1 4 1 3 3 6 1 3 4 3\n [741] 6 5 5 6 6 2 4 2 6 3 1 1 3 1 2 2 4 5 4 5 3 1 6 1 6 1 5 2 2 1 3 4 2 6 5 4 3\n [778] 2 1 1 4 2 1 2 1 5 1 2 6 5 4 3 3 2 5 2 2 5 2 3 4 5 4 5 2 1 1 6 3 5 2 5 1 6\n [815] 1 3 6 1 3 4 2 3 4 5 1 1 2 3 1 1 2 2 1 5 1 2 6 1 1 1 6 2 2 5 4 1 3 5 2 2 2\n [852] 2 6 3 4 5 2 5 1 5 1 1 2 2 3 5 2 2 3 6 5 2 1 3 6 4 5 1 5 4 5 5 1 1 6 1 2 5\n [889] 5 3 2 1 3 6 2 1 2 1 6 2 2 5 3 6 4 3 2 2 6 6 2 2 2 3 2 1 1 1 6 6 2 2 6 6 6\n [926] 2 1 4 2 3 5 3 2 1 4 1 1 3 6 6 6 6 2 6 1 6 6 5 6 5 6 6 6 6 2 2 3 2 5 4 6 2\n [963] 2 3 6 4 5 1 5 3 5 6 1 5 4 3 4 3 5 6 6 2 4 5 5 4 5 6 6 6 4 3 6 2 4 2 1 4 4\n[1000] 2\n```\n\n\n:::\n:::\n\n\n\nThe probability of rolling a 3 or higher based on 1000 simulated dice rolls is\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025) # set seed for reproducibility\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.449\n```\n\n\n:::\n:::\n\n\n\nIf we were to repeat this simulation (without setting seed) five times, we get\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.43\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.546\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.525\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.471\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(sample(1:6,1000,replace=TRUE)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.631\n```\n\n\n:::\n:::\n\n\n\nSo no, every time this is repeated, we will get different sequences of simulated rolls, and will therefore have different estimates for the probability of rolling 3+.\n\nHence, it is important to set a seed for reproducibility purposes so other people can confirm our results.\n:::\n\n::: {.callout-question collapsed=\"true\"}\n### Question 3\n\nConsider the word ‘STATISTICS’. Is the number of unique arrangements of the letters in ‘STATISTICS’ 10!? Justify your answer and compute the probability that a random rearrangement of the letters in ‘STATISTICS’ will spell the word ‘STATISTICS’.\n:::\n\n:::: {.callout-tip collapse=\"true\"}\n### Solution\n\nNo, because some letters are repeated. The word \"STATISTICS\" has 10 letters in total, but with repeated letters: S 3 times, T 3 times, I 2 times, and A, C appear once each.\n\nTo count the number of distinct permutations, we divide 10! by the factorials of the repeated letters: $\\dfrac{10!}{3! \\times 3! \\times 2!} = \\dfrac{3628800}{72} = 50400$.\n\n::: callout-note\n**Theorem: Permutations of a multiset**.\n\n*Let S be a set with n (not necessarily distinct objects), such that there are* $n_1$ objects of type 1, $n_2$ objects of type 2, $\\cdots$, $n_k$ objects of type k, where $n_1 + n_2 + ... + n_k = n$. Then the number of arrangements of these objects is $\\dfrac{n!}{n_1! \\times n_2! \\times \\cdots \\times n_k!}$\n:::\n\nSince there is only one unique arrangement of the word \"STATISTICS\", the probability is $\\boxed{\\dfrac{1}{50400}}$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnumerator <- 1\ndenominator <- factorial(10) / (factorial(3)*factorial(3)*factorial(2))\n\n(prob <- numerator/denominator)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.984127e-05\n```\n\n\n:::\n:::\n\n\n::::\n\n::: {.callout-question collapsed=\"true\"}\n### Question 4\n\nAssume birthdays are equally likely to occur in each of the 12 months of the year. What is the probability that at least two people in a group of three students have birth months in common? Be sure to show your steps.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nIt is easier to work with complements when you see the phrase \"at least\". So that we get $$\\begin{align*}\nP(\\text{at least one shared}) \n&= 1 - P(\\text{all different}) \\\\\n&= 1 - \\frac{12 \\times 11 \\times 10}{12^3} \\\\\n&= 1 - \\frac{11 \\times 10}{12^2} \\\\\n&= 1 - \\frac{110}{144} \\\\\n&= 1 - 0.7639 \\\\\n&= \\boxed{0.2361}\n\\end{align*}$$\n\n------------------------------------------------------------------------\n\nAlternatively, let \\begin{align*}\nA &= \\text{first student is assigned any birth month (no restriction)} \\\\\nB &= \\text{second student has a different birth month from the first} \\\\\nC &= \\text{third student has a different birth month from both the first and second}\n\\end{align*}\n\nThen, \\begin{align*}\nP(A \\cap B \\cap C) \n&= P(A) \\cdot P(B \\mid A) \\cdot P(C \\mid A \\cap B) \\\\\n&= 1 \\cdot \\frac{11}{12} \\cdot \\frac{10}{12} \\\\\n&= \\frac{110}{144} \\\\\n&\\approx 0.7639\n\\end{align*}\n\nSo the probability that at least two students share a birth month is: \\begin{align*}\nP(\\text{at least one shared}) \n&= 1 - P(\\text{all different}) \\\\\n&= 1 - 0.7639 \\\\\n&= \\boxed{0.2361}\n\\end{align*}\n:::\n\n------------------------------------------------------------------------\n\n# Week 2\n\n::: {.callout-question collapse=\"true\"}\n### Question 1\n\nSuppose that the moment generating function of $Y$ is given by $$M_Y(t) = e^{(a+b)(e^t - 1)}$$\n\nwhere $a > 0$ and $b > 0$. Use this mgf to find the\n\n**a)** expected value of $Y$ and\n\n**b)** the variance of $Y$.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** The expected value of $Y$ is the first derivative of the mgf evaluated at $t = 0$: $$\\mathbb{E}[Y] = M_Y'(0)$$ Hence, $$M_Y'(t) = \\frac{d}{dt} e^{(a+b)(e^t - 1)} = e^{(a+b)(e^t - 1)} \\cdot (a+b)e^t$$ Evaluated at $t = 0$: $$\\mathbb{E}(Y) = M_Y'(0) = e^{(a+b)(1 - 1)} \\cdot (a+b) \\cdot 1 = (a + b)$$\n\n------------------------------------------------------------------------\n\n**b)** The variance of $Y$ is: $$\\mathrm{Var}(Y) = M_Y''(0) - \\left( M_Y'(0) \\right)^2$$\n\nHence, \\begin{align*}\nM_Y''(t) &= \\frac{d}{dt} \\left[ e^{(a+b)(e^t - 1)} \\cdot (a+b)e^t \\right] \\\\\n&= e^{(a+b)(e^t - 1)} \\cdot (a+b)e^t \\cdot \\left[ (a+b)e^t + 1 \\right]\n\\end{align*}\n\nEvaluate at $t = 0$: $$M_Y''(0) = 1 \\cdot (a+b) \\cdot \\left[ (a+b)(1) + 1 \\right] = (a + b)^2 + (a + b)$$ Lastly, $$\\mathrm{Var}(Y) = (a + b)^2 + (a + b) - (a + b)^2 = a + b$$\n:::\n\n::: callout-note\n**Fact: Uniqueness of mgfs**. If two random variables $X$ and $Y$ have mgfs $M_X(t)$ and $M_Y(t)$, and there exists an open interval around $t = 0$ where both mgfs exist and are equal, then $$X = Y$$ That is, $X$ and $Y$ have the same distribution.\n:::\n\n::: {.callout-question collapse=\"true\"}\n### Question 2\n\nSuppose $X$ has a Discrete Uniform Distribution over the values $x = 1,2,3,4,5$.\n\n**a)** Sketch the pmf and cdf.\n\n**b)** Find the mgf of $X$.\n\n**c)** Compute $\\mathbb{E}(X)$ and $\\mathbb{V}(X)$ two ways: by using the definitions, and by using the mgf you found in part b.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** To plot the pmf and cdf in R:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- 1:5\n\n# PMF: Each has equal probability\npmf <- rep(1/5, length(x))\n\n# CDF: Cumulative sum of PMF\ncdf <- cumsum(pmf)\n\n# Plot PMF\nplot(x, pmf, type=\"h\", lwd=2, col=\"blue\", ylim=c(0, 1),\n     main=\"PMF of X\", ylab=\"P(X = x)\", xlab=\"x\")\npoints(x, pmf, pch=16, col=\"blue\")\n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot CDF\nplot(x, cdf, type=\"s\", lwd=2, col=\"red\",\n     main=\"CDF of X\", ylab=\"P(X ≤ x)\", xlab=\"x\")\npoints(x, cdf, pch=16, col=\"red\")\n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n**b)** Now we find the mgf. By definition,\n\n$$M_X(t) = \\mathbb{E}[e^{tX}] = \\sum_{x=1}^{5} e^{tx} \\cdot \\frac{1}{5} = \\frac{1}{5} \\left( e^t + e^{2t} + e^{3t} + e^{4t} + e^{5t} \\right)$$\n\n------------------------------------------------------------------------\n\n**c)** Lastly, we compute $\\mathbb{E}(X)$ and $\\mathbb{V}(X)$.\n\nFirst way: by definition\n\n$$\\mathbb{E}(X) = \\frac{1}{5}(1 + 2 + 3 + 4 + 5) = \\frac{15}{5} = 3$$ $$\\mathbb{E}(X^2) = \\frac{1}{5}(1^2 + 2^2 + 3^2 + 4^2 + 5^2) = \\frac{1}{5}(55) = 11$$ $$\\mathrm{Var}(X) = \\mathbb{E}(X^2) - (\\mathbb{E}(X))^2 = 11 - 3^2 = 11 - 9 = 2$$\n\nSecond way: MFG approach $$M_X(t) = \\frac{1}{5} \\left( e^t + e^{2t} + e^{3t} + e^{4t} + e^{5t} \\right)$$ First derivative and evaluate at $t = 0$ $$M_X'(t) = \\frac{1}{5} \\left( e^t \\cdot 1 + e^{2t} \\cdot 2 + e^{3t} \\cdot 3 + e^{4t} \\cdot 4 + e^{5t} \\cdot 5 \\right)$$\n\n$$M_X'(0) = \\frac{1}{5}(1 + 2 + 3 + 4 + 5) = 3$$ Second derivative and evaluate at $t = 0$ $$M_X''(t) = \\frac{1}{5} \\left( e^t \\cdot 1^2 + e^{2t} \\cdot 2^2 + e^{3t} \\cdot 3^2 + e^{4t} \\cdot 4^2 + e^{5t} \\cdot 5^2 \\right)$$ $$M_X''(0) = \\frac{1}{5}(1 + 4 + 9 + 16 + 25) = \\frac{55}{5} = 11$$\n\nLastly, $$\\mathrm{Var}(X) = M_X''(0) - \\left( M_X'(0) \\right)^2 = 11 - 9 = 2$$\n:::\n\n::: {.callout-question collapse=\"true\"}\n### Question 3\n\nOf the thousands of the volunteers who donate blood at a clinic, $80\\%$ have the Rhesus (Rh) factor present in their blood. For the purposes of this question, assume the population size is very large (ie., we can use methods that assume sampling with replacement).\n\n**a)** If six volunteers are randomly selected, what is the probability that no one has the Rh factor?\n\n**b)** If six volunteers are randomly selected, what is the probability that at most four have the Rh factor?\n\n**c)** What if we were interested in the smallest number of volunteers who must be randomly selected if we want to be at least $90\\%$ certain we will obtain at least four donors with the Rh factor? Can we answer this question using a Binomial Distribution? If so, answer this question. If not, explain why a Binomial distribution is not an appropriate model in this situation.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** We model this situation using the Binomial distribution, which is appropriate when the population is large, the number of trials $n$ is fixed, outcomes are binary (success or failure), and trials are independent. Although the true model is hypergeometric due to sampling without replacement, the large population size makes the Binomial a good approximation, as sampling with and without replacement become nearly equivalent (in fact, one can show via the pmfs that $\\lim_{N \\to \\infty}$ Hypergeometric$(N, K = pN, n)$ = Binomial $(n, p)$).\n\nWith this in mind, let $X \\sim$ binom$(n, p = 0.8)$ where $p =$ probability that a volunteer has the Rh factor.\n\n------------------------------------------------------------------------\n\n**b)** Once again let $X \\sim \\text{Binomial}(n = 6, p = 0.8)$, where $X$ is the number of people with the Rh factor. Then, $$P(X = 0) = \\binom{6}{0}(0.8)^0(0.2)^6 = 1 \\cdot 1 \\cdot (0.2)^6 = \\boxed{0.000064}$$\n\nIn R,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbinom(0, 6, 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.4e-05\n```\n\n\n:::\n:::\n\n\n\nLet $X \\sim \\text{Binomial}(n = 6, p = 0.8)$, where $X$ is the number of people with the Rh factor. Then $$P(X \\leq 4) = 1 - P(X = 5) - P(X = 6) $$ Note that\n\n\\begin{aligned}\nP(X = 5) &= \\binom{6}{5}(0.8)^5(0.2)^1 = 6 \\cdot 0.32768 \\cdot 0.2 = 0.39322 \\\\\nP(X = 6) &= \\binom{6}{6}(0.8)^6(0.2)^0 = 1 \\cdot 0.262144 \\cdot 1 = 0.26214 \\\\\n\\end{aligned}\n\nHence, $$P(X \\leq 4) = 1 - 0.39322 - 0.26214 = \\boxed{0.34464}$$\n\nIn R,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npbinom(4, 6, 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.34464\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n**c)** In this scenario, the number of trials $n$ is not fixed anymore since we are adjusting $n$ to find the smallest number of volunteers. Hence, a binomial distribution would not be appropriate anymore (see part a solution for a detailed requirement for modelling using binomial distribution).\n\nWe would use trial and error approach, computing $P(X \\ge 4)$ for different binomial distributions to determine the smallest $n$ where $P(X \\ge 4)$ is at least $0.9$.\n:::\n\n# Week 3\n\n::: {.callout-question collapse=\"true\"}\n### Question 1\n\nApplicants for a new student internship are accepted with probability $p = 0.15$ independently from person to person in the order the applicants are received. Several hundred people are expected to apply. The number of students they will accept is $10$.\n\n**a)** Find the probability that it will take no more than $100$ applicants to find $10$ students to accept for the program.\n\n**b)** Find the expected value of the number of interviews they will have to undertake to accept $10$ interns.\n\n**c)** Calculate the standard deviation for the number of interviews.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** Let $X \\sim \\text{NB}(10, 0.15)$ be the number of interviews.\n\nThen we wish to find $$P(X \\leq 100) = \\sum_{x=10}^{100} \\binom{x - 1}{r - 1} 0.15^{10}(1 - 0.15)^{x - 10} = 0.945$$ In R,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnbinom(100-10, 10, 0.15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9449054\n```\n\n\n:::\n:::\n\n\n\nTo visualize the pmf, we use the R code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Parameters\nr <- 10       # number of successes\np <- 0.15     # probability of success\nmax_x <- 150  # max number of trials\n\n# Create x values (total trials)\nx_vals <- r:(r + max_x - 1)  # total trials from 10 to 159\n\n# Compute probabilities for failures = 0 to 149\nprobs <- dnbinom(0:(max_x - 1), size = r, prob = p)\n\n# Plotting\nbarplot(\n  probs,\n  names.arg = x_vals,\n  xlab = \"Number of trials (x)\",\n  ylab = \"P(X = x)\",\n  main = expression(X %~% NegBin(10, 0.15)),\n  cex.names = 0.7  # shrink axis labels to avoid overlap\n)\n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n**b)** We use the formula of expected value of negative binomial distribution $$\\mathbb{E}(X) = \\frac{10}{0.15} = 66.66$$\n\n------------------------------------------------------------------------\n\n**c)**We use the formula of variance of negative binomial distribution, then square root it $$\\sigma = \\sqrt{ \\frac{10(1 - 0.15)}{0.15^2} } = 19.43$$\n:::\n\n::: {.callout-question collapse=\"true\"}\n### Question 2\n\nAn insurance policy costs \\$400 and will pay policy holders \\$40,000 if they suffer a major injury (resulting in hospitalization) or \\$10,000 if they suffer a minor injury (resulting in lost time from work but no hospitalization). The company estimates that each year, 1 in every 5000 of their policyholders has a major injury, and 1 in 1000 has a minor injury. Let ( X ) be the profit on an insurance policy. The probability model for the profit on a policy is shown in the following table:\n\n\\begin{array}{|c|c|c|}\n\\hline\n\\text{Type} & X & P(X = x) \\\\\n\\hline\n\\text{Major Injury} & -\\$39,\\!600 & \\dfrac{1}{5000} \\\\\n\\text{Minor Injury} & -\\$9,\\!600 & \\dfrac{1}{1000} \\\\\n\\text{Neither} & \\$400 & \\dfrac{4994}{5000} \\\\\n\\hline\n\\end{array}\n\nOn the Week 4 course reflection, you found $\\mathbb{E}(X) = \\$382$ and $\\text{SD}(X) = \\$648$ based on this probability model using the definitions of $\\mathbb{E}(X)$ and $\\text{SD}(X)$.\n\n**a)** Find the moment generating function (mgf) for $X$ and use it to find $\\mathbb{E}(X)$ and $\\text{SD}(X)$.\n\n**b)** Suppose that 10,000 customers purchased this insurance policy in 2023.\n\n(i) Simulate 10,000 values of the profit on a policy in R using the above probability model.\\\n(ii) What is the average of the simulated profits? How does this compare to the theoretical value?\\\n(iii) What is the standard deviation of the simulated profits? How does this compare to the theoretical value?\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** Let $X$ be the amount of profit on an insurance policy.\n\nWe first find the mgf. By definition, $$M_X(t) = \\mathbb{E}(e^{tX}) = e^{-39600t} \\cdot \\frac{1}{5000}\n       + e^{-9600t} \\cdot \\frac{1}{1000}\n       + e^{400t} \\cdot \\frac{4994}{5000}$$\n\nNext we differientiate the mgf. $$\nM_X'(t) = \\frac{d}{dt} M_X(t) \n= -39600 e^{-39600t} \\cdot \\frac{1}{5000}\n- 9600 e^{-9600t} \\cdot \\frac{1}{1000}\n+ 400 e^{400t} \\cdot \\frac{4994}{5000}\n$$ $$\nM_X''(t) = (39600)^2 e^{-39600t} \\cdot \\frac{1}{5000}\n+ (9600)^2 e^{-9600t} \\cdot \\frac{1}{1000}\n+ (400)^2 e^{400t} \\cdot \\frac{4994}{5000}\n$$\n\nWe get the expected value at $t=0$ of $M_X'(t)$: $$\n\\mathbb{E}(X) = M_X'(0) = (-39600) \\cdot \\frac{1}{5000} \n+ (-9600) \\cdot \\frac{1}{1000} \n+ 400 \\cdot \\frac{4994}{5000} = \\boxed{382}\n$$\n\nSimilarly we get the second moment, evaluating $t=0$ of $M_X''(t)$: $$M_X''(0) = 39600^2 \\cdot \\frac{1}{5000}\n+ 9600^2 \\cdot \\frac{1}{1000}\n+ 400^2 \\cdot \\frac{4994}{5000} = 565472000\n$$\n\nLastly we find the SD: $$\\text{SD}(X) = \\sqrt{M_X''(0) - [M_X'(0)]^2} = \\sqrt{565472000 - 382^2} = \\sqrt{565326076} \\approx \\boxed{648}$$\n\n------------------------------------------------------------------------\n\n**b)** To simulate using R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)  # for reproducibility\n\n# Define possible outcomes and their probabilities\noutcomes <- c(-39600, -9600, 400)\nprobs <- c(1/5000, 1/1000, 4994/5000)\n\n# Simulate 10,000 profits\nsimulated_profits <- sample(outcomes, size = 10000, replace = TRUE, prob = probs)\n```\n:::\n\n\n\nTo get the average of the simulated profits,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(simulated_profits)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 381\n```\n\n\n:::\n:::\n\n\n\nWe see it is very close to the theoretocal expected value $382$.\n\nLastly, to get the standard deviation,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(simulated_profits)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 655.5013\n```\n\n\n:::\n:::\n\n\n\nWe see it is very close to the theoretical standard deviation of $648$.\n:::\n\n# Midterm Review\n\n::: {.callout-question collapse=\"true\"}\n**Solutions will not be posted for these questions.**\n\n## Question 1\n\nThe probability mass function $p_X(x)$, for a discrete variable $X$ is given in the following table.\n\n\\begin{array}{|c|c|c|c|}\n\\hline\nX & 0 & 1 & 2 \\\\\n\\hline\np_X(x) & \\dfrac{1}{3} & \\dfrac{1}{6} & \\dfrac{1}{2} \\\\\n\\hline\n\\end{array}\n\n**a)** Let $Y = |X - 1|$. Be sure to show your steps for the following questions.\n\n(i) What is the probability mass function of $Y$?\\\n(ii) What is the moment generating function of $Y$?\n(iii) Compute the mean and variance of $Y$.\n\n**b)** Suppose we flip a coin $2X$ times, where $X$ follows the pmf given in the table in this question and record the number of heads. Let event $A= \\text{more than one head}$, and $B = \\text{coin is flipped twice}$. Consider the following R code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim <- NULL\nN <- 5000\n\nfor (i in 1:N){\n  x <- sample(0:2, size = 1, prob = c(1/3, 1/6, 1/2))\n  flips <- sample(0:1, size=2*x, replace=TRUE)\n  if (sum(flips) > 1 & x == 1){\n    success <- 1\n  } else{\n    success <- 0\n  }\n  sim[i] <- success\n}\n\nmean(sim)\n```\n:::\n\n\n\n(i) Which of the following probabilities does the above code estimate? Circle the appropriate option.\n\n\\begin{array}{ccc}\nP(A) & P(B) & P(A \\cap B) \\\\\nP(A \\cup B) & P(A \\mid B) & P(B \\mid A)\n\\end{array}\n\n(ii) Compute this probability and list any probability rules/principles that you apply.\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 2\n\nFor each of the following R commands, specify the relevant probability distribution and its parameters, and compute the value this code would produce, showing the steps of your calculations.\n\na)  rpois(10, 0.5)\nb)  dbinom(2, 4, 0.1)\nc)  mean(sample(1:6, 1000, replace=TRUE))\nd)  pnbinom(1, 1, 0.2)\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 3\n\nIt is estimated that $45\\%$ of all emails are spam (i.e., junk email). Many of these are marked by spam filters and sent directly to junk mail folders. Some are not. Suppose you are exploring characteristics of messages that might help predict whether or not a message is spam to build a spam filter.\n\nSuppose $25\\%$ of spam emails contain the word \"free\" compared to $5\\%$ of non-spam emails, $15\\%$ of spam emails contain the phrase \"subject to credit approval\" compared to $1\\%$ of non-spam emails. Further, suppose $10\\%$ of spam messages include the word \"free\" \\emph{or} the phrase \"subject to credit approval\", $80\\%$ of non-spam messages contain neither the word \"free\" nor the phrase \"subject to credit approval\". Randomly select an incoming email message. Let $A$, $B$, and $C$ represent the following events: \\begin{align*}\nA &= \\text{email is spam (i.e., junk mail)}, \\\\\nB &= \\text{email contains the word ``free''}, \\\\\nC &= \\text{email contains the phrase ``subject to credit approval''}.\n\\end{align*}\n\n**a)** Consider the event that the randomly selected incoming email message is spam but does not include the word \"free\", nor the phrase \"subject to credit approval\". Answer parts (i)-(iii) based on this event.\\\n(i) Write this event down in the appropriate set notation: \\underline{\\hspace{4cm}} (ii) Draw a Venn Diagram of this sample space and shade in this event.\\\n(iii) Compute the probability of this event and list any probability rules/principles that you apply.\n\n**b)** What is the probability that a randomly selected email message is spam given it does not include the word \"free\", nor the phrase \"subject to credit approval\"?\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 4\n\nYou are trying to pull an all-nighter to study the night before an exam (**don’t do this for STA237H1**!). There are 10 more hours until your exam. The amount of time, in hours, that you can stay awake to study for can be modeled by a random variable $X$ with PDF $$\nf(x) = \n\\begin{cases}\nce^{-0.25(x - 2)}, & 2 < x < 10 \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$ where $c$ is a constant.\n\na)  What is the constant $c$ that makes this a valid PDF?\nb)  You know you need $4$ hours to go over enough material to pass your exam, and otherwise, you will fail. What is the probability that you pass your exam? Sketch the PDF, mark this probability on your plot, and compute this probability.\nc)  What is the probability that you study for exactly $5$ hours? Sketch the PDF again and mark this probability on your plot.\nd)  You find out that your exam is entirely multiple choice, and if you study for less than $4$ hours, there is a $30\\%$ probability that you will pass your exam by randomly guessing the answers. If you study for more than $4$ hours, you will pass for sure. What is the probability that you will pass the exam now? Compute the probability of this event and list any probability rules/principles that you apply.\n:::\n\n# Week 5\n\n::: {.callout-question collapse=\"true\"}\n## Question 1\n\nSuppose $Y$ has pdf $$f_Y(y) = \n\\begin{cases}\nc(2 - y), & 0 \\leq y \\leq 2 \\\\\n0, & \\text{otherwise}\n\\end{cases}$$\n\nFor this distribution, find each of the following. Be sure to show your steps.\n\n**a)** $c$\n\n**b)** $F_Y(y)$\n\n**c)** $\\mathbb{P}(1 < Y \\leq 2)$\n\n**d)** The expected value and variance of a continuous random variable can be determined using its pdf, similar to how we used pmfs for discrete random variables; now instead of summing, we integrate.\n\n(i) $E(Y) = \\int_{-\\infty}^{\\infty} y f_Y(y) \\, dy$\n(ii) $V(Y) = \\int_{-\\infty}^{\\infty} [y - E(Y)]^2 f_Y(y) \\, dy$\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** Using the fact that the total area under the curve of a valid pdf must be $1$, we have do the following\n\n\\begin{align*}\nc \\int_0^2 (2 - y) \\, dy &= 1 \\\\\nc \\left[ 2y - \\frac{y^2}{2} \\right]_0^2 &= 1 \\\\\nc \\left( 2(2) - \\frac{2^2}{2} \\right) &= 1 \\\\\nc(4 - 2) &= 1 \\\\\n2c &= 1 \\\\\n\\Rightarrow \\boxed{c = \\frac{1}{2}}\n\\end{align*}\n\n------------------------------------------------------------------------\n\n**b)** We find the cdf by integrating the pdf:\n\n$$\\boxed{\nF_Y(y) = \n\\begin{cases}\n0, & y < 0 \\\\[6pt]\n\\displaystyle \\int_0^y \\frac{1}{2}(2 - t) \\, dt = y - \\dfrac{y^2}{4}, & 0 \\leq y \\leq 2 \\\\[6pt]\n1, & y > 2\n\\end{cases}}\n$$\n\n------------------------------------------------------------------------\n\n**c)** Since $$\\mathbb{P}(1 < Y \\leq 2) = F_Y(2) - F_Y(1)$$ So then from part b, we can compute\n\n\\begin{align*}\nF_Y(2) &= 2 - \\frac{2^2}{4} = 2 - 1 = 1 \\\\\nF_Y(1) &= 1 - \\frac{1^2}{4} = 1 - \\frac{1}{4} = \\frac{3}{4}\n\\end{align*}\n\nThus, $$\\mathbb{P}(1 < Y \\leq 2) = 1 - \\frac{3}{4} = \\boxed{\\frac{1}{4}}$$\n\n------------------------------------------------------------------------\n\n**d)**\n\ni)  We compute the mean of $Y$ from the definition,\n\n\\begin{align*}\n\\mu = \\mathbb{E}(Y) \n&= \\int_0^2 y \\cdot \\frac{1}{2}(2 - y) \\, dy \\\\\n&= \\frac{1}{2} \\int_0^2 y(2 - y) \\, dy \\\\\n&= \\frac{1}{2} \\int_0^2 (2y - y^2) \\, dy \\\\\n&= \\frac{1}{2} \\left[ y^2 - \\frac{y^3}{3} \\right]_0^2 \\\\\n&= \\frac{1}{2} \\left( 4 - \\frac{8}{3} \\right) \\\\\n&= \\frac{1}{2} \\cdot \\frac{4}{3} = \\boxed{\\frac{2}{3}}\n\\end{align*}\n\nii) Like in the discrete case, we can express the variance $\\mathbb{V}(Y) = \\mathbb{E}(Y^2) - \\left( \\mathbb{E}(Y) \\right)^2$.So first, we get\n\n\\begin{align*}\n\\mathbb{E}(Y^2) \n&= \\int_0^2 y^2 \\cdot \\frac{1}{2}(2 - y) \\, dy \\\\\n&= \\frac{1}{2} \\int_0^2 (2y^2 - y^3) \\, dy \\\\\n&= \\frac{1}{2} \\left[ \\frac{2y^3}{3} - \\frac{y^4}{4} \\right]_0^2 \\\\\n&= \\frac{1}{2} \\left( \\frac{16}{3} - \\frac{16}{4} \\right) \\\\\n&= \\frac{1}{2} \\left( \\frac{16}{3} - 4 \\right) = \\frac{1}{2} \\cdot \\frac{4}{3} = \\boxed{\\frac{2}{3}}\n\\end{align*}\n\nThen, \\begin{align*}\n\\sigma^2 = \\mathbb{V}(Y) \n&= \\mathbb{E}(Y^2) - \\left( \\mathbb{E}(Y) \\right)^2 \\\\\n&= \\frac{2}{3} - \\left( \\frac{2}{3} \\right)^2 \\\\\n&= \\frac{2}{3} - \\frac{4}{9} = \\boxed{\\frac{2}{9}}\n\\end{align*}\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 2\n\nConsider the continuous random variable $X$ with pdf given by\n\n$$\nf_X(x) = \n\\begin{cases}\n2e^{-2x}, & x \\geq 0 \\\\\n0, & \\text{otherwise}\n\\end{cases}\n$$\n\n**a)** What is the cdf of $X$?\n\n**b)** Find $E(X)$. Be sure to show your steps.\n\n**c)** Determine $F^{-1}(U)$ and use R to simulate 10,000 observations from this pdf by the inverse transform method. Note that the *runif(n, min = a, max = b)* R function can be used to simulate $n$ realizations of a $Unif(a, b)$ random variable.\n\n**d)** Compute the mean of the generated observations and compare the result with $E(X)$ that was obtained in part (b).\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n**a)** We need to integrate the pdf to get the final answer\n\n$$\\boxed{\nF_X(x) = \n\\begin{cases}\n0, & x < 0 \\\\[6pt]\n1 - e^{-2x}, & x \\geq 0\n\\end{cases}\n}$$\n\n------------------------------------------------------------------------\n\n**b)** We use the definition of the expected value\n\n\\begin{align*}\n\\mathbb{E}(X) &= \\int_{0}^{\\infty} x \\cdot 2e^{-2x} \\, dx\n\\end{align*}\n\nUse integration by parts:\n\nLet $u = x$, $dv = 2e^{-2x}dx$\\\nThen $du = dx$, $v = -e^{-2x}$\n\n\\begin{align*}\n\\mathbb{E}(X) &= \\left[ -x e^{-2x} \\right]_0^\\infty + \\int_0^\\infty e^{-2x} \\, dx \\\\\n&= 0 + \\left[ -\\frac{1}{2} e^{-2x} \\right]_0^\\infty \\\\\n&= \\boxed{\\frac{1}{2}}\n\\end{align*}\n\n------------------------------------------------------------------------\n\n**c)**\n\nFrom part a, we found that $$F_X(x) = 1 - e^{-2x}, \\quad x \\geq 0$$\n\nLet ( U \\sim \\text{Uniform}(0, 1) ), and solve: \\begin{align*}\nU &= 1 - e^{-2x} \\\\\ne^{-2x} &= 1 - U \\\\\n-2x &= \\ln(1 - U) \\\\\nx &= -\\frac{1}{2} \\ln(1 - U)\n\\end{align*}\n\nSo the inverse cdf is $F_X^{-1}(U) = -\\frac{1}{2} \\ln(1 - U)$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\n\n# Parameters\nlambda <- 2\nn <- 10000\n\n# Inverse transform sampling\nu <- runif(n)\nx <- -log(1 - u) / lambda\n\n# Plot histogram with density overlay\nhist(\n  x,\n  breaks = 30,\n  probability = TRUE,\n  col = \"skyblue\",\n  border = \"white\",\n  xlab = \"x\",\n  main = \"Histogram of Simulated X Values (Inverse Transform)\"\n)\n\n# Overlay true exponential density for comparison\ncurve(dexp(x, rate = lambda), col = \"darkred\", lwd = 2, add = TRUE)\nlegend(\"topright\", legend = c(\"True density exp(2)\"), col = \"darkred\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n**d)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5003358\n```\n\n\n:::\n:::\n\n\n\nNote that this (ie. the expected value calculated using the Inverse Transform Method) is very close to the theoretical mean of the exponential distribution in part b.\n:::\n\n::: callout-note\n**Note: Inverse Transform Method**. In part c, we've learned how to simulate random values from a specific distribution using just uniform random numbers (which computers are really good at generating).\n\nSince we want values from an Exponential distribution, and we already know its cdf, we can work backwards to get a formula that tells us how to turn a Uniform(0,1) value into an Exponential one. This is the [inverse transform method](https://en.wikipedia.org/wiki/Inverse_transform_sampling).\n\nThis is indeed how R's built-in function *rexp()* (and for many other distributions) work under the hood.\n:::\n\n# Week 6\n\nA continuous random variable $X$ is said to have a pareto distribution with location parameter $m$ and shape parameter $a$, if its probability density function is of the form $$f(x) = \\frac{a m^a}{x^{a+1}}, \\quad \\text{for } x \\geq m$$ and zero if $x < m$.\n\nVilfredo Pareto originally used this distribution to describe the allocation of wealth among individuals since it seemed to show rather well the way that a larger portion of the wealth of any society is owned by a smaller percentage of the people in that society. He also used it to describe distribution of income. This idea is sometimes expressed more simply as the Pareto principle or the \"80-20 rule\" which says that $20\\%$ of the population controls $80\\%$ of the wealth. Today, the Pareto distribution is often used to model catastrophic events where a claim might have a very large value (e.g., extreme weather events, war, etc.). We denote it as $X \\sim \\text{Par}(m, a)$, where $m, a > 0$.\n\nThis distribution is right-skewed, and it is characterized by its heavy long tail. One way to plot this pdf in R is given by the following code:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"EnvStats\") \nlibrary(EnvStats) \nn<-100; m<-1; a<-0.5 # location=1 & shape=0.5 \nx<-seq(1,20,length=n) # equally-spaced sequence from 1 to 20 \ny<-dpareto(x,m,a) \nplot(x,y,type=\"l\") \nabline(h=0,lty=2) # adds dotted line at y=0\n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\nThere are no built-in pareto distribution functions in base R, so we need to first install and load R package *EnvStats* to use the functions *dpareto()*, *ppareto()*, *qpareto()* and *rpareto()*. In these functions, the location (m) and shape (a) parameters should be entered as the second and third arguments, respectively, unless you name them (i.e., define location=, and shape= in the inputs).\n\nThe mean and variance diverge if parameter α is not large enough. In particular, the mean is $$\\mu = E(X) = \\frac{am}{a - 1} \\quad \\text{if } a > 1$$\n\nand the variance is\\\n$$\\sigma^2 = \\mathrm{Var}(X) = \\frac{am^2}{(a - 1)^2 (a - 2)} \\quad \\text{if } a > 2$$ If $a \\le 1$ the mean is infinity (diverges) and if $a \\le 2$ the variance is infinity (diverges). For this reason, the moment generating function does not exist.\n\nThe cumulative distribution function is given in closed form $$F(x) = 1 - \\left( \\frac{m}{x} \\right)^a \\quad \\text{for } x \\geq m$$\n\nand zero otherwise.\n\nThe p-th quantile (or 100p-th percentile), denoted as $x_p$ is given by $$x_p = m(1 - p)^{-\\frac{1}{a}}$$\n\n:::::::: {.callout-question collapse=\"true\"}\n## Question 1\n\nProve that when $a = m = 1$, then $\\mathbb{E}(X)$ does not exist (it diverges to infinity).\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nBy definition, $$E(X) = \\int_1^{\\infty} x \\cdot \\frac{1}{x^2} \\, dx = \\int_1^{\\infty} \\frac{1}{x} \\, dx = \\log(x)\\big|_1^{\\infty} = \\lim_{x \\to \\infty} \\log(x) - \\log(1) = \\infty - 0 = \\infty\n$$\n:::\n\n## Question 2\n\nFor $a = m = 1$, obtain the pth quantiles where $p = 0.5, 0.75, 0.9, 0.95, 0.99$.\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nUsing the formula $x_p = \\frac{1}{1 - p}$, we plug in and see that $$x_{0.5} = 2,\\ x_{0.75} = 4,\\ x = 2,\\ x_{0.95} = 20,\\ x_{0.99} = 100$$\n\nTo derive the formula from the cdf, set $a = m = 1$ $$F(x) = 1 - \\frac{1}{x}$$ To find the p-th quantile, we solve $$F(x_p) = p \\implies 1 - \\frac{1}{x_p} = p \\implies x_p = \\frac{1}{1-p}$$\n:::\n\n## Question 3\n\nSample $n=100$ random values from a Pareto distribution with parameters $a = 0.5$ and $m=1$. Plot a histogram of the simulated values and use them to compute the sample mean and variance of the $100$ values. Compare the sample mean and sample variance with the theoretical values. Is this a good approximation of the theoretical mean and variance? If not, how could it be improved?\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nn <- 100\na <- 0.5\nm <- 1\nx <- rpareto(n,m,a) \nhist(x) \n```\n\n::: {.cell-output-display}\n![](STA237-Summer-2025_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmean(x) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2885.227\n```\n\n\n:::\n\n```{.r .cell-code}\nvar(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 483067593\n```\n\n\n:::\n:::\n\n\n\nSince $a < 1$, the mean and variance are both infinity. So the estimated mean and variance will not match their theoretical counterparts.\n\nThe issue lies within having too small of an $a$, leading the distribution to be heavily right-skewed. For the estimation to be more accurate, we need a larger $a$ (e.g. $a > 2$). Note that increasing sample size won't help much in this case, since the mean and variance are infinity.\n:::\n\n## Question 4\n\nIn a population, suppose personal income above $\\$22,000$ has a Pareto distribution with $a = 2.8$ (units are $\\$10,000$). Find the probability that a randomly chosen individual’s income is greater than $4$ standard deviations above the mean.\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nWe first find the mean and variance $$\\mu = \\frac{a m}{a - 1} = \\frac{2.8 \\times 2.2}{2.8 - 1}  \\approx 3.422$$\n\n$$\\sigma^2 = \\frac{a m^2}{(a - 1)^2 (a - 2)} \n= \\frac{2.8 \\times 2.2^2}{(2.8 - 1)^2 \\times (2.8-2)} \n\\approx 5.2284 \\implies \\sigma \\approx \\sqrt{5.2284} \\approx 2.287$$\n\nNext, we compute the threshold (here $k = 4$) $$\\mu + 4\\sigma \\approx 3.422 + 4 \\times 2.287 = 12.57$$ Lastly, we use the Pareto cdf to compute the probability $$P(X > x) = \\left( \\frac{m}{x} \\right)^a\n\\Rightarrow P(X > 12.57) = \\left( \\frac{2.2}{12.57} \\right)^{2.8} \\approx \\boxed{0.0076}$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1-ppareto(4*sqrt(5.228395)+3.422222, location=2.2, \nshape=2.8) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.007599592\n```\n\n\n:::\n:::\n\n\n:::\n\n## Question 5\n\nThe aggregate losses on an auto insurance policy follow a Pareto distribution with $a = 4$ and $m = 800$. What’s the probability that the aggregate losses on a random policy exceed $\\$1000$?\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nLet $X$ denote the aggregate losses on an auto insurance, so $X \\sim \\text{Par}(m = 800, a = 4)$.\n\nThen $$P(X > 1000) = \\left( \\frac{800}{1000} \\right)^4 = 0.4096$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1-ppareto(1000,800,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4096\n```\n\n\n:::\n:::\n\n\n:::\n\n## Question 6\n\nSuppose the income of a certain population has a Pareto distribution with $a=3$ and $m=1000$. What is the proportion of the population with incomes between $2000$ and $4000$?\n::::::::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\nLet $X$ denote the income of a certain population. It follows that $X \\text{Par}(1000, 3)$.\n\nThe desired proportion is given by\n\n$$P(2000 < X < 4000) = F(4000) - F(2000) = \\left( \\frac{1000}{2000} \\right)^3 - \\left( \\frac{1000}{4000} \\right)^3 = 0.1094$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nppareto(4000,1000,3)-ppareto(2000,1000,3) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.109375\n```\n\n\n:::\n:::\n\n\n:::\n\n# Week 7\n\n::: {.callout-question collapse=\"true\"}\n## Question 1\n\nThe joint pdf of $X$ and $Y$, $f_{X,Y}(x,y)$, is non-zero on $0 \\le y \\le x \\le 1$.\n\n**a)** Sketch and clearly mark the support of this joint probability distribution on the axes to the right. Explicitly mark boundaries (i.e., $y = x$ line, and $x/y = 0 \\& 1$).\n\n**b)** Consider $P(Y \\ge 1/2)$. \n\n(i) Add and clearly mark the integration region to compute this probability on the axes in the right and\n(ii) determine the limits of integration (i.e., $a, b, c,$ and $d$) in \n$$P\\left(Y > \\frac{1}{2}\\right) = \\int_a^b \\int_{1/2}^d f_{X,Y}(x, y) \\, dy \\, dx$$ and list below\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n:::\n\n\n::: {.callout-question collapse=\"true\"}\n## Question 2\n\nThe joint pdf of $X$ and $Y$, $f_{X,Y}(x,y)$, is non-zero on $0 \\le x \\le 1, 0 \\le y, \\le 2x$.\n\n**a)** Sketch and clearly mark the support of this joint probability distribution on the axes to the right. Mark boundaries (i.e., $y = 2x$ line, $x = 0 \\& 1$)\n\n**b)** Consider $P(1/2 < X < 1)$.\n\n(i) Add and clearly mark the integration region to compute this probability on the axes in the right and\n(ii) probability on the axes in the right and (ii) determine the limits of integration (i.e., $a, b, c,$ and $d$) in  \n$$P\\left(\\frac{1}{2} < X < 1\\right) = \\int_a^b \\int_c^d f_{X,Y}(x, y) \\, dy \\, dx$$ and list below.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 3\n\nSuppose $X$ has pdf $$f_X(x) =\n\\begin{cases}\n60x^2(1 - x)^3, & 0 < x < 1 \\\\\n0, & \\text{otherwise}\n\\end{cases}$$\nFind the pdf of $Y = X^3$.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n:::\n\n::: {.callout-question collapse=\"true\"}\n## Question 4\n\nSuppose $1000$ people are surveyed about their smoking habits and classified as a smoker or non-smoker. The information is summarized in the table below:\n\n\n\\begin{array}{|c|c|c|c|}\n\\hline\nSmoker \\backslash Age Group & \\le 18 & 19-54 & 55+ \\\\\n\\hline\nYes & 25 & 125 & 150 \\\\\n\\hline\nNo & 260 & 205 & 235 \\\\\n\\hline\n\\end{array}\n\n\n**a)** What is the marginal probability mass function that describes smoking habits and age group among those surveyed? Write down this distribution and define any new notation that you use. \n\n**b)** How can we quantify the relationship between smoking and age group using the methods we learned in the course? Interpret what this means in real life terms.\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Solution\n\n:::\n\n[Exam solutions](https://www.youtube.com/watch?v=dQw4w9WgXcQ)",
    "supporting": [
      "STA237-Summer-2025_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}