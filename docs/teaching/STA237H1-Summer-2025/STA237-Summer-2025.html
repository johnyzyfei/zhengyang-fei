<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Notes for STA237 Summer 2025">

<title>STA237: Probability, Statistics and Data Analysis I – Zhengyang (John) Fei</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Zhengyang (John) Fei</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../project.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.qmd"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/johnyzyfei/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/zhengyang-fei"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-1" id="toc-week-1" class="nav-link active" data-scroll-target="#week-1">Week 1</a></li>
  <li><a href="#week-2" id="toc-week-2" class="nav-link" data-scroll-target="#week-2">Week 2</a></li>
  <li><a href="#week-3" id="toc-week-3" class="nav-link" data-scroll-target="#week-3">Week 3</a></li>
  <li><a href="#midterm-review" id="toc-midterm-review" class="nav-link" data-scroll-target="#midterm-review">Midterm Review</a></li>
  <li><a href="#week-5" id="toc-week-5" class="nav-link" data-scroll-target="#week-5">Week 5</a></li>
  <li><a href="#week-6" id="toc-week-6" class="nav-link" data-scroll-target="#week-6">Week 6</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA237: Probability, Statistics and Data Analysis I</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Probability</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">Simulations</div>
  </div>
  </div>

<div>
  <div class="description">
    Notes for STA237 Summer 2025
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Acknowledgements: This page contains tutorial notes for <a href="https://artsci.calendar.utoronto.ca/course/sta237h1">STA237H1 Probability, Statistics and Data Analysis I</a> Summer 2025 under the instruction of <a href="https://graciadong.github.io/">Dr.&nbsp;Gracia Yunruo Dong</a>.</p>
<section id="week-1" class="level1">
<h1>Week 1</h1>
<section id="question-1" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-1">Question 1</h3>
<p><strong>b)</strong> Suppose <span class="math inline">\(\Omega = \{1, 2, 3, 4, 5, 6\}\)</span> and let <span class="math inline">\(A = \{1, 2, 4, 5\}\)</span>, <span class="math inline">\(B = \{1, 3, 5\}\)</span> and <span class="math inline">\(C = \{2, 4, 6\}\)</span>. Use this example to verify the two results in the distributive law.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We need to verify two things.</p>
<ol type="i">
<li><span class="math inline">\(A \cap (B \cup C) = (A \cap B) \cup (A \cap C)\)</span></li>
</ol>
<p><span class="math display">\[\begin{align*}
B \cup C &amp;=  \{1, 2, 3, 4, 5, 6\} \\
A \cap (B \cup C) &amp;=  \{1, 2, 4, 5\} \\
A \cap B &amp;=  \{1, 5\} \\
A \cap C &amp;=  \{2, 4\} \\
(A \cap B) \cup (A \cap C) &amp;=  \{1, 2, 4, 5\}
\end{align*}\]</span></p>
<p>Therefore, <span class="math inline">\(A \cap (B \cup C) = (A \cap B) \cup (A \cap C)\)</span> as required.</p>
<ol start="2" type="i">
<li><span class="math inline">\(A \cup (B \cap C) = (A \cup B) \cap (A \cup C)\)</span></li>
</ol>
<p><span class="math display">\[\begin{align*}
B \cap C &amp;= \{1, 3, 5\} \cap \{2, 4, 6\} = \emptyset \\
A \cup (B \cap C) &amp;=  \{1, 2, 4, 5\} \\
A \cup B &amp;=  \{1, 2, 3, 4, 5\} \\
A \cup C &amp;=  \{1, 2, 4, 5, 6\} \\
(A \cup B) \cap (A \cup C) &amp;= \{1, 2, 4, 5\}
\end{align*}\]</span></p>
<p>Therefore, <span class="math inline">\(A \cup (B \cap C) = (A \cup B) \cap (A \cup C)\)</span> as required.</p>
</div>
</div>
</div>
<section id="question-2" class="level3 callout-question" data-collapsed="true">
<h3 class="anchored" data-anchor-id="question-2">Question 2</h3>
<p>In R, write R code to simulate rolling a fair six-sided die once, 10 times, 100 times, and 1000 times.</p>
<p><strong>a)</strong> Estimate the probability of rolling a 3 or higher based on 1000 simulated dice rolls.</p>
<p><strong>b)</strong> If you were to repeat your simulation, would you end up with the same estimate? Why or why not.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first simulate the rolling of a fair six-sided die 10, 100, and 1000 times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="co"># Rolling a fair six-sided die 10 times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5 4 4 2 1 6 3 2 5 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># 100 times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 4 4 3 3 5 3 3 6 5 5 1 4 1 6 3 6 4 3 2 3 5 3 5 4 2 2 1 3 2 2 1 3 3 1 6 4 4
 [38] 2 5 3 3 1 3 6 2 1 1 1 6 2 4 1 5 2 5 5 6 3 1 6 4 4 6 5 3 4 2 2 2 5 2 1 1 5
 [75] 4 6 3 6 4 4 1 4 5 4 4 6 2 5 1 6 4 5 4 6 2 4 4 6 3 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1000</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># 1000 times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] 2 1 2 6 3 2 4 6 5 1 2 6 2 2 1 2 1 6 4 4 1 6 3 6 2 3 2 4 1 1 6 1 1 2 6 5 2
  [38] 3 5 4 5 4 6 4 4 4 5 2 4 6 4 6 5 3 4 5 4 1 3 3 2 4 4 6 4 3 3 2 6 1 1 2 4 6
  [75] 4 4 2 6 6 4 3 3 2 3 6 3 6 1 6 1 3 2 4 1 6 5 3 6 2 2 5 6 4 4 3 4 1 3 3 2 4
 [112] 3 4 5 5 4 5 2 1 3 1 5 2 3 5 6 5 4 1 4 5 4 3 2 6 1 2 5 6 2 5 3 1 6 4 3 2 5
 [149] 4 5 2 4 4 2 6 2 6 4 2 2 3 1 6 3 1 3 3 6 4 1 6 2 1 3 6 3 4 1 3 3 6 1 5 6 1
 [186] 1 2 2 1 1 2 1 6 4 6 2 4 4 3 1 1 3 5 1 5 2 3 3 6 5 4 2 6 5 5 6 3 1 3 1 1 3
 [223] 1 5 4 5 6 2 1 3 1 6 3 3 3 6 2 4 5 5 3 4 1 3 6 1 1 1 4 4 5 1 4 2 5 4 6 3 4
 [260] 3 4 4 4 1 6 3 4 6 5 1 5 4 4 3 5 3 6 1 6 6 5 3 1 5 3 2 1 2 2 6 1 3 5 1 3 6
 [297] 1 5 4 5 5 2 4 6 4 1 3 1 6 2 3 1 4 4 5 6 5 1 4 2 1 1 4 4 3 3 1 2 1 4 6 4 3
 [334] 5 4 2 2 5 3 5 3 6 5 3 6 3 3 2 3 6 1 4 4 1 3 6 6 5 6 5 3 2 2 3 4 2 3 6 5 1
 [371] 2 3 2 2 5 4 6 4 3 1 2 2 5 2 4 6 6 4 6 1 2 4 1 2 1 4 6 3 3 2 3 6 1 1 3 3 3
 [408] 2 4 3 1 6 1 1 2 4 3 1 2 4 4 5 3 3 2 5 1 5 6 4 4 6 5 1 1 6 6 1 3 6 1 5 5 4
 [445] 2 6 5 6 1 2 6 5 1 6 2 2 6 1 5 3 5 4 6 2 1 4 6 2 6 5 3 4 6 6 4 4 3 4 6 6 2
 [482] 3 6 1 1 1 4 2 4 3 2 2 4 2 2 6 2 3 6 5 6 4 4 6 6 3 5 6 3 5 4 6 2 4 4 6 1 4
 [519] 3 5 1 1 6 4 1 5 1 4 5 2 2 6 2 2 4 4 1 5 4 1 4 1 5 3 4 6 2 1 5 1 5 3 4 6 1
 [556] 6 4 2 1 4 3 4 1 3 6 1 3 2 6 2 3 1 1 5 6 6 1 1 2 4 5 5 2 2 5 4 6 1 6 5 6 5
 [593] 4 4 4 5 6 1 3 1 5 5 3 4 1 3 2 4 2 5 4 6 5 6 6 1 3 3 4 3 6 6 6 3 1 2 2 6 2
 [630] 3 1 4 6 1 2 4 3 5 1 4 3 6 5 4 5 3 3 6 6 1 6 3 1 3 1 4 1 5 6 5 4 4 4 6 5 6
 [667] 4 3 2 2 3 6 1 1 6 5 3 3 3 2 5 5 5 1 4 4 4 4 6 2 5 1 4 1 5 6 4 3 6 3 1 4 3
 [704] 4 1 3 6 3 6 6 2 6 4 2 5 4 1 4 3 4 3 1 2 3 3 6 5 3 6 2 1 4 1 3 3 6 1 3 4 3
 [741] 6 5 5 6 6 2 4 2 6 3 1 1 3 1 2 2 4 5 4 5 3 1 6 1 6 1 5 2 2 1 3 4 2 6 5 4 3
 [778] 2 1 1 4 2 1 2 1 5 1 2 6 5 4 3 3 2 5 2 2 5 2 3 4 5 4 5 2 1 1 6 3 5 2 5 1 6
 [815] 1 3 6 1 3 4 2 3 4 5 1 1 2 3 1 1 2 2 1 5 1 2 6 1 1 1 6 2 2 5 4 1 3 5 2 2 2
 [852] 2 6 3 4 5 2 5 1 5 1 1 2 2 3 5 2 2 3 6 5 2 1 3 6 4 5 1 5 4 5 5 1 1 6 1 2 5
 [889] 5 3 2 1 3 6 2 1 2 1 6 2 2 5 3 6 4 3 2 2 6 6 2 2 2 3 2 1 1 1 6 6 2 2 6 6 6
 [926] 2 1 4 2 3 5 3 2 1 4 1 1 3 6 6 6 6 2 6 1 6 6 5 6 5 6 6 6 6 2 2 3 2 5 4 6 2
 [963] 2 3 6 4 5 1 5 3 5 6 1 5 4 3 4 3 5 6 6 2 4 5 5 4 5 6 6 6 4 3 6 2 4 2 1 4 4
[1000] 2</code></pre>
</div>
</div>
<p>The probability of rolling a 3 or higher based on 1000 simulated dice rolls is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.449</code></pre>
</div>
</div>
<p>If we were to repeat this simulation (without setting seed) five times, we get</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.43</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.546</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.471</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.631</code></pre>
</div>
</div>
<p>So no, every time this is repeated, we will get different sequences of simulated rolls, and will therefore have different estimates for the probability of rolling 3+.</p>
<p>Hence, it is important to set a seed for reproducibility purposes so other people can confirm our results.</p>
</div>
</div>
</div>
<section id="question-3" class="level3 callout-question" data-collapsed="true">
<h3 class="anchored" data-anchor-id="question-3">Question 3</h3>
<p>Consider the word ‘STATISTICS’. Is the number of unique arrangements of the letters in ‘STATISTICS’ 10!? Justify your answer and compute the probability that a random rearrangement of the letters in ‘STATISTICS’ will spell the word ‘STATISTICS’.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>No, because some letters are repeated. The word “STATISTICS” has 10 letters in total, but with repeated letters: S 3 times, T 3 times, I 2 times, and A, C appear once each.</p>
<p>To count the number of distinct permutations, we divide 10! by the factorials of the repeated letters: <span class="math inline">\(\dfrac{10!}{3! \times 3! \times 2!} = \dfrac{3628800}{72} = 50400\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Theorem: Permutations of a multiset</strong>.</p>
<p><em>Let S be a set with n (not necessarily distinct objects), such that there are</em> <span class="math inline">\(n_1\)</span> objects of type 1, <span class="math inline">\(n_2\)</span> objects of type 2, <span class="math inline">\(\cdots\)</span>, <span class="math inline">\(n_k\)</span> objects of type k, where <span class="math inline">\(n_1 + n_2 + ... + n_k = n\)</span>. Then the number of arrangements of these objects is <span class="math inline">\(\dfrac{n!}{n_1! \times n_2! \times \cdots \times n_k!}\)</span></p>
</div>
</div>
<p>Since there is only one unique arrangement of the word “STATISTICS”, the probability is <span class="math inline">\(\boxed{\dfrac{1}{50400}}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>numerator <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> <span class="fu">factorial</span>(<span class="dv">10</span>) <span class="sc">/</span> (<span class="fu">factorial</span>(<span class="dv">3</span>)<span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">3</span>)<span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">2</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>(prob <span class="ot">&lt;-</span> numerator<span class="sc">/</span>denominator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.984127e-05</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="question-4" class="level3 callout-question" data-collapsed="true">
<h3 class="anchored" data-anchor-id="question-4">Question 4</h3>
<p>Assume birthdays are equally likely to occur in each of the 12 months of the year. What is the probability that at least two people in a group of three students have birth months in common? Be sure to show your steps.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It is easier to work with complements when you see the phrase “at least”. So that we get <span class="math display">\[\begin{align*}
P(\text{at least one shared})
&amp;= 1 - P(\text{all different}) \\
&amp;= 1 - \frac{12 \times 11 \times 10}{12^3} \\
&amp;= 1 - \frac{11 \times 10}{12^2} \\
&amp;= 1 - \frac{110}{144} \\
&amp;= 1 - 0.7639 \\
&amp;= \boxed{0.2361}
\end{align*}\]</span></p>
<hr>
<p>Alternatively, let <span class="math display">\[\begin{align*}
A &amp;= \text{first student is assigned any birth month (no restriction)} \\
B &amp;= \text{second student has a different birth month from the first} \\
C &amp;= \text{third student has a different birth month from both the first and second}
\end{align*}\]</span></p>
<p>Then, <span class="math display">\[\begin{align*}
P(A \cap B \cap C)
&amp;= P(A) \cdot P(B \mid A) \cdot P(C \mid A \cap B) \\
&amp;= 1 \cdot \frac{11}{12} \cdot \frac{10}{12} \\
&amp;= \frac{110}{144} \\
&amp;\approx 0.7639
\end{align*}\]</span></p>
<p>So the probability that at least two students share a birth month is: <span class="math display">\[\begin{align*}
P(\text{at least one shared})
&amp;= 1 - P(\text{all different}) \\
&amp;= 1 - 0.7639 \\
&amp;= \boxed{0.2361}
\end{align*}\]</span></p>
</div>
</div>
</div>
<hr>
</section>
<section id="week-2" class="level1">
<h1>Week 2</h1>
<section id="question-1-1" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-1-1">Question 1</h3>
<p>Suppose that the moment generating function of <span class="math inline">\(Y\)</span> is given by <span class="math display">\[M_Y(t) = e^{(a+b)(e^t - 1)}\]</span></p>
<p>where <span class="math inline">\(a &gt; 0\)</span> and <span class="math inline">\(b &gt; 0\)</span>. Use this mgf to find the</p>
<p><strong>a)</strong> expected value of <span class="math inline">\(Y\)</span> and</p>
<p><strong>b)</strong> the variance of <span class="math inline">\(Y\)</span>.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> The expected value of <span class="math inline">\(Y\)</span> is the first derivative of the mgf evaluated at <span class="math inline">\(t = 0\)</span>: <span class="math display">\[\mathbb{E}[Y] = M_Y'(0)\]</span> Hence, <span class="math display">\[M_Y'(t) = \frac{d}{dt} e^{(a+b)(e^t - 1)} = e^{(a+b)(e^t - 1)} \cdot (a+b)e^t\]</span> Evaluated at <span class="math inline">\(t = 0\)</span>: <span class="math display">\[\mathbb{E}(Y) = M_Y'(0) = e^{(a+b)(1 - 1)} \cdot (a+b) \cdot 1 = (a + b)\]</span></p>
<hr>
<p><strong>b)</strong> The variance of <span class="math inline">\(Y\)</span> is: <span class="math display">\[\mathrm{Var}(Y) = M_Y''(0) - \left( M_Y'(0) \right)^2\]</span></p>
<p>Hence, <span class="math display">\[\begin{align*}
M_Y''(t) &amp;= \frac{d}{dt} \left[ e^{(a+b)(e^t - 1)} \cdot (a+b)e^t \right] \\
&amp;= e^{(a+b)(e^t - 1)} \cdot (a+b)e^t \cdot \left[ (a+b)e^t + 1 \right]
\end{align*}\]</span></p>
<p>Evaluate at <span class="math inline">\(t = 0\)</span>: <span class="math display">\[M_Y''(0) = 1 \cdot (a+b) \cdot \left[ (a+b)(1) + 1 \right] = (a + b)^2 + (a + b)\]</span> Lastly, <span class="math display">\[\mathrm{Var}(Y) = (a + b)^2 + (a + b) - (a + b)^2 = a + b\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Fact: Uniqueness of mgfs</strong>. If two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have mgfs <span class="math inline">\(M_X(t)\)</span> and <span class="math inline">\(M_Y(t)\)</span>, and there exists an open interval around <span class="math inline">\(t = 0\)</span> where both mgfs exist and are equal, then <span class="math display">\[X = Y\]</span> That is, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the same distribution.</p>
</div>
</div>
<section id="question-2-1" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-2-1">Question 2</h3>
<p>Suppose <span class="math inline">\(X\)</span> has a Discrete Uniform Distribution over the values <span class="math inline">\(x = 1,2,3,4,5\)</span>.</p>
<p><strong>a)</strong> Sketch the pmf and cdf.</p>
<p><strong>b)</strong> Find the mgf of <span class="math inline">\(X\)</span>.</p>
<p><strong>c)</strong> Compute <span class="math inline">\(\mathbb{E}(X)\)</span> and <span class="math inline">\(\mathbb{V}(X)\)</span> two ways: by using the definitions, and by using the mgf you found in part b.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> To plot the pmf and cdf in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># PMF: Each has equal probability</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="fu">length</span>(x))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF: Cumulative sum of PMF</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(pmf)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PMF</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pmf, <span class="at">type=</span><span class="st">"h"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"PMF of X"</span>, <span class="at">ylab=</span><span class="st">"P(X = x)"</span>, <span class="at">xlab=</span><span class="st">"x"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, pmf, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot CDF</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, cdf, <span class="at">type=</span><span class="st">"s"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"CDF of X"</span>, <span class="at">ylab=</span><span class="st">"P(X ≤ x)"</span>, <span class="at">xlab=</span><span class="st">"x"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, cdf, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong>b)</strong> Now we find the mgf. By definition,</p>
<p><span class="math display">\[M_X(t) = \mathbb{E}[e^{tX}] = \sum_{x=1}^{5} e^{tx} \cdot \frac{1}{5} = \frac{1}{5} \left( e^t + e^{2t} + e^{3t} + e^{4t} + e^{5t} \right)\]</span></p>
<hr>
<p><strong>c)</strong> Lastly, we compute <span class="math inline">\(\mathbb{E}(X)\)</span> and <span class="math inline">\(\mathbb{V}(X)\)</span>.</p>
<p>First way: by definition</p>
<p><span class="math display">\[\mathbb{E}(X) = \frac{1}{5}(1 + 2 + 3 + 4 + 5) = \frac{15}{5} = 3\]</span> <span class="math display">\[\mathbb{E}(X^2) = \frac{1}{5}(1^2 + 2^2 + 3^2 + 4^2 + 5^2) = \frac{1}{5}(55) = 11\]</span> <span class="math display">\[\mathrm{Var}(X) = \mathbb{E}(X^2) - (\mathbb{E}(X))^2 = 11 - 3^2 = 11 - 9 = 2\]</span></p>
<p>Second way: MFG approach <span class="math display">\[M_X(t) = \frac{1}{5} \left( e^t + e^{2t} + e^{3t} + e^{4t} + e^{5t} \right)\]</span> First derivative and evaluate at <span class="math inline">\(t = 0\)</span> <span class="math display">\[M_X'(t) = \frac{1}{5} \left( e^t \cdot 1 + e^{2t} \cdot 2 + e^{3t} \cdot 3 + e^{4t} \cdot 4 + e^{5t} \cdot 5 \right)\]</span></p>
<p><span class="math display">\[M_X'(0) = \frac{1}{5}(1 + 2 + 3 + 4 + 5) = 3\]</span> Second derivative and evaluate at <span class="math inline">\(t = 0\)</span> <span class="math display">\[M_X''(t) = \frac{1}{5} \left( e^t \cdot 1^2 + e^{2t} \cdot 2^2 + e^{3t} \cdot 3^2 + e^{4t} \cdot 4^2 + e^{5t} \cdot 5^2 \right)\]</span> <span class="math display">\[M_X''(0) = \frac{1}{5}(1 + 4 + 9 + 16 + 25) = \frac{55}{5} = 11\]</span></p>
<p>Lastly, <span class="math display">\[\mathrm{Var}(X) = M_X''(0) - \left( M_X'(0) \right)^2 = 11 - 9 = 2\]</span></p>
</div>
</div>
</div>
<section id="question-3-1" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-3-1">Question 3</h3>
<p>Of the thousands of the volunteers who donate blood at a clinic, <span class="math inline">\(80\%\)</span> have the Rhesus (Rh) factor present in their blood. For the purposes of this question, assume the population size is very large (ie., we can use methods that assume sampling with replacement).</p>
<p><strong>a)</strong> If six volunteers are randomly selected, what is the probability that no one has the Rh factor?</p>
<p><strong>b)</strong> If six volunteers are randomly selected, what is the probability that at most four have the Rh factor?</p>
<p><strong>c)</strong> What if we were interested in the smallest number of volunteers who must be randomly selected if we want to be at least <span class="math inline">\(90\%\)</span> certain we will obtain at least four donors with the Rh factor? Can we answer this question using a Binomial Distribution? If so, answer this question. If not, explain why a Binomial distribution is not an appropriate model in this situation.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> We model this situation using the Binomial distribution, which is appropriate when the population is large, the number of trials <span class="math inline">\(n\)</span> is fixed, outcomes are binary (success or failure), and trials are independent. Although the true model is hypergeometric due to sampling without replacement, the large population size makes the Binomial a good approximation, as sampling with and without replacement become nearly equivalent (in fact, one can show via the pmfs that <span class="math inline">\(\lim_{N \to \infty}\)</span> Hypergeometric<span class="math inline">\((N, K = pN, n)\)</span> = Binomial <span class="math inline">\((n, p)\)</span>).</p>
<p>With this in mind, let <span class="math inline">\(X \sim\)</span> binom<span class="math inline">\((n, p = 0.8)\)</span> where <span class="math inline">\(p =\)</span> probability that a volunteer has the Rh factor.</p>
<hr>
<p><strong>b)</strong> Once again let <span class="math inline">\(X \sim \text{Binomial}(n = 6, p = 0.8)\)</span>, where <span class="math inline">\(X\)</span> is the number of people with the Rh factor. Then, <span class="math display">\[P(X = 0) = \binom{6}{0}(0.8)^0(0.2)^6 = 1 \cdot 1 \cdot (0.2)^6 = \boxed{0.000064}\]</span></p>
<p>In R,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.4e-05</code></pre>
</div>
</div>
<p>Let <span class="math inline">\(X \sim \text{Binomial}(n = 6, p = 0.8)\)</span>, where <span class="math inline">\(X\)</span> is the number of people with the Rh factor. Then <span class="math display">\[P(X \leq 4) = 1 - P(X = 5) - P(X = 6) \]</span> Note that</p>
<span class="math display">\[\begin{aligned}
P(X = 5) &amp;= \binom{6}{5}(0.8)^5(0.2)^1 = 6 \cdot 0.32768 \cdot 0.2 = 0.39322 \\
P(X = 6) &amp;= \binom{6}{6}(0.8)^6(0.2)^0 = 1 \cdot 0.262144 \cdot 1 = 0.26214 \\
\end{aligned}\]</span>
<p>Hence, <span class="math display">\[P(X \leq 4) = 1 - 0.39322 - 0.26214 = \boxed{0.34464}\]</span></p>
<p>In R,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.34464</code></pre>
</div>
</div>
<hr>
<p><strong>c)</strong> In this scenario, the number of trials <span class="math inline">\(n\)</span> is not fixed anymore since we are adjusting <span class="math inline">\(n\)</span> to find the smallest number of volunteers. Hence, a binomial distribution would not be appropriate anymore (see part a solution for a detailed requirement for modelling using binomial distribution).</p>
<p>We would use trial and error approach, computing <span class="math inline">\(P(X \ge 4)\)</span> for different binomial distributions to determine the smallest <span class="math inline">\(n\)</span> where <span class="math inline">\(P(X \ge 4)\)</span> is at least <span class="math inline">\(0.9\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="week-3" class="level1">
<h1>Week 3</h1>
<section id="question-1-2" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-1-2">Question 1</h3>
<p>Applicants for a new student internship are accepted with probability <span class="math inline">\(p = 0.15\)</span> independently from person to person in the order the applicants are received. Several hundred people are expected to apply. The number of students they will accept is <span class="math inline">\(10\)</span>.</p>
<p><strong>a)</strong> Find the probability that it will take no more than <span class="math inline">\(100\)</span> applicants to find <span class="math inline">\(10\)</span> students to accept for the program.</p>
<p><strong>b)</strong> Find the expected value of the number of interviews they will have to undertake to accept <span class="math inline">\(10\)</span> interns.</p>
<p><strong>c)</strong> Calculate the standard deviation for the number of interviews.</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> Let <span class="math inline">\(X \sim \text{NB}(10, 0.15)\)</span> be the number of interviews.</p>
<p>Then we wish to find <span class="math display">\[P(X \leq 100) = \sum_{x=10}^{100} \binom{x - 1}{r - 1} 0.15^{10}(1 - 0.15)^{x - 10} = 0.945\]</span> In R,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">100-10</span>, <span class="dv">10</span>, <span class="fl">0.15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9449054</code></pre>
</div>
</div>
<p>To visualize the pmf, we use the R code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">10</span>       <span class="co"># number of successes</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.15</span>     <span class="co"># probability of success</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>max_x <span class="ot">&lt;-</span> <span class="dv">150</span>  <span class="co"># max number of trials</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create x values (total trials)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> r<span class="sc">:</span>(r <span class="sc">+</span> max_x <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># total trials from 10 to 159</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute probabilities for failures = 0 to 149</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(<span class="dv">0</span><span class="sc">:</span>(max_x <span class="sc">-</span> <span class="dv">1</span>), <span class="at">size =</span> r, <span class="at">prob =</span> p)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  probs,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">names.arg =</span> x_vals,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Number of trials (x)"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"P(X = x)"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(X <span class="sc">%~%</span> <span class="fu">NegBin</span>(<span class="dv">10</span>, <span class="fl">0.15</span>)),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.names =</span> <span class="fl">0.7</span>  <span class="co"># shrink axis labels to avoid overlap</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong>b)</strong> We use the formula of expected value of negative binomial distribution <span class="math display">\[\mathbb{E}(X) = \frac{10}{0.15} = 66.66\]</span></p>
<hr>
<p><strong>c)</strong>We use the formula of variance of negative binomial distribution, then square root it <span class="math display">\[\sigma = \sqrt{ \frac{10(1 - 0.15)}{0.15^2} } = 19.43\]</span></p>
</div>
</div>
</div>
<section id="question-2-2" class="level3 callout-question" data-collapse="true">
<h3 class="anchored" data-anchor-id="question-2-2">Question 2</h3>
<p>An insurance policy costs $400 and will pay policy holders $40,000 if they suffer a major injury (resulting in hospitalization) or $10,000 if they suffer a minor injury (resulting in lost time from work but no hospitalization). The company estimates that each year, 1 in every 5000 of their policyholders has a major injury, and 1 in 1000 has a minor injury. Let ( X ) be the profit on an insurance policy. The probability model for the profit on a policy is shown in the following table:</p>
<span class="math display">\[\begin{array}{|c|c|c|}
\hline
\text{Type} &amp; X &amp; P(X = x) \\
\hline
\text{Major Injury} &amp; -\$39,\!600 &amp; \dfrac{1}{5000} \\
\text{Minor Injury} &amp; -\$9,\!600 &amp; \dfrac{1}{1000} \\
\text{Neither} &amp; \$400 &amp; \dfrac{4994}{5000} \\
\hline
\end{array}\]</span>
<p>On the Week 4 course reflection, you found <span class="math inline">\(\mathbb{E}(X) = \$382\)</span> and <span class="math inline">\(\text{SD}(X) = \$648\)</span> based on this probability model using the definitions of <span class="math inline">\(\mathbb{E}(X)\)</span> and <span class="math inline">\(\text{SD}(X)\)</span>.</p>
<p><strong>a)</strong> Find the moment generating function (mgf) for <span class="math inline">\(X\)</span> and use it to find <span class="math inline">\(\mathbb{E}(X)\)</span> and <span class="math inline">\(\text{SD}(X)\)</span>.</p>
<p><strong>b)</strong> Suppose that 10,000 customers purchased this insurance policy in 2023.</p>
<ol type="i">
<li>Simulate 10,000 values of the profit on a policy in R using the above probability model.<br>
</li>
<li>What is the average of the simulated profits? How does this compare to the theoretical value?<br>
</li>
<li>What is the standard deviation of the simulated profits? How does this compare to the theoretical value?</li>
</ol>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> Let <span class="math inline">\(X\)</span> be the amount of profit on an insurance policy.</p>
<p>We first find the mgf. By definition, <span class="math display">\[M_X(t) = \mathbb{E}(e^{tX}) = e^{-39600t} \cdot \frac{1}{5000}
       + e^{-9600t} \cdot \frac{1}{1000}
       + e^{400t} \cdot \frac{4994}{5000}\]</span></p>
<p>Next we differientiate the mgf. <span class="math display">\[
M_X'(t) = \frac{d}{dt} M_X(t)
= -39600 e^{-39600t} \cdot \frac{1}{5000}
- 9600 e^{-9600t} \cdot \frac{1}{1000}
+ 400 e^{400t} \cdot \frac{4994}{5000}
\]</span> <span class="math display">\[
M_X''(t) = (39600)^2 e^{-39600t} \cdot \frac{1}{5000}
+ (9600)^2 e^{-9600t} \cdot \frac{1}{1000}
+ (400)^2 e^{400t} \cdot \frac{4994}{5000}
\]</span></p>
<p>We get the expected value at <span class="math inline">\(t=0\)</span> of <span class="math inline">\(M_X'(t)\)</span>: <span class="math display">\[
\mathbb{E}(X) = M_X'(0) = (-39600) \cdot \frac{1}{5000}
+ (-9600) \cdot \frac{1}{1000}
+ 400 \cdot \frac{4994}{5000} = \boxed{382}
\]</span></p>
<p>Similarly we get the second moment, evaluating <span class="math inline">\(t=0\)</span> of <span class="math inline">\(M_X''(t)\)</span>: <span class="math display">\[M_X''(0) = 39600^2 \cdot \frac{1}{5000}
+ 9600^2 \cdot \frac{1}{1000}
+ 400^2 \cdot \frac{4994}{5000} = 565472000
\]</span></p>
<p>Lastly we find the SD: <span class="math display">\[\text{SD}(X) = \sqrt{M_X''(0) - [M_X'(0)]^2} = \sqrt{565472000 - 382^2} = \sqrt{565326076} \approx \boxed{648}\]</span></p>
<hr>
<p><strong>b)</strong> To simulate using R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define possible outcomes and their probabilities</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">39600</span>, <span class="sc">-</span><span class="dv">9600</span>, <span class="dv">400</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5000</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>, <span class="dv">4994</span><span class="sc">/</span><span class="dv">5000</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 10,000 profits</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>simulated_profits <span class="ot">&lt;-</span> <span class="fu">sample</span>(outcomes, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the average of the simulated profits,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(simulated_profits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 381</code></pre>
</div>
</div>
<p>We see it is very close to the theoretocal expected value <span class="math inline">\(382\)</span>.</p>
<p>Lastly, to get the standard deviation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(simulated_profits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 655.5013</code></pre>
</div>
</div>
<p>We see it is very close to the theoretical standard deviation of <span class="math inline">\(648\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="midterm-review" class="level1">
<h1>Midterm Review</h1>
<div class="callout-question" data-collapse="true">
<p><strong>Solutions will not be posted for these questions.</strong></p>
<section id="question-1-3" class="level2">
<h2 class="anchored" data-anchor-id="question-1-3">Question 1</h2>
<p>The probability mass function <span class="math inline">\(p_X(x)\)</span>, for a discrete variable <span class="math inline">\(X\)</span> is given in the following table.</p>
<span class="math display">\[\begin{array}{|c|c|c|c|}
\hline
X &amp; 0 &amp; 1 &amp; 2 \\
\hline
p_X(x) &amp; \dfrac{1}{3} &amp; \dfrac{1}{6} &amp; \dfrac{1}{2} \\
\hline
\end{array}\]</span>
<p><strong>a)</strong> Let <span class="math inline">\(Y = |X - 1|\)</span>. Be sure to show your steps for the following questions.</p>
<ol type="i">
<li>What is the probability mass function of <span class="math inline">\(Y\)</span>?<br>
</li>
<li>What is the moment generating function of <span class="math inline">\(Y\)</span>?</li>
<li>Compute the mean and variance of <span class="math inline">\(Y\)</span>.</li>
</ol>
<p><strong>b)</strong> Suppose we flip a coin <span class="math inline">\(2X\)</span> times, where <span class="math inline">\(X\)</span> follows the pmf given in the table in this question and record the number of heads. Let event <span class="math inline">\(A= \text{more than one head}\)</span>, and <span class="math inline">\(B = \text{coin is flipped twice}\)</span>. Consider the following R code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  flips <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(flips) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    success <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  sim[i] <span class="ot">&lt;-</span> success</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="i">
<li>Which of the following probabilities does the above code estimate? Circle the appropriate option.</li>
</ol>
<span class="math display">\[\begin{array}{ccc}
P(A) &amp; P(B) &amp; P(A \cap B) \\
P(A \cup B) &amp; P(A \mid B) &amp; P(B \mid A)
\end{array}\]</span>
<ol start="2" type="i">
<li>Compute this probability and list any probability rules/principles that you apply.</li>
</ol>
</section>
</div>
<section id="question-2-3" class="level2 callout-question" data-collapse="true">
<h2 class="anchored" data-anchor-id="question-2-3">Question 2</h2>
<p>For each of the following R commands, specify the relevant probability distribution and its parameters, and compute the value this code would produce, showing the steps of your calculations.</p>
<ol type="a">
<li>rpois(10, 0.5)</li>
<li>dbinom(2, 4, 0.1)</li>
<li>mean(sample(1:6, 1000, replace=TRUE))</li>
<li>pnbinom(1, 1, 0.2)</li>
</ol>
</section>
<section id="question-3-2" class="level2 callout-question" data-collapse="true">
<h2 class="anchored" data-anchor-id="question-3-2">Question 3</h2>
<p>It is estimated that <span class="math inline">\(45\%\)</span> of all emails are spam (i.e., junk email). Many of these are marked by spam filters and sent directly to junk mail folders. Some are not. Suppose you are exploring characteristics of messages that might help predict whether or not a message is spam to build a spam filter.</p>
<p>Suppose <span class="math inline">\(25\%\)</span> of spam emails contain the word “free” compared to <span class="math inline">\(5\%\)</span> of non-spam emails, <span class="math inline">\(15\%\)</span> of spam emails contain the phrase “subject to credit approval” compared to <span class="math inline">\(1\%\)</span> of non-spam emails. Further, suppose <span class="math inline">\(10\%\)</span> of spam messages include the word “free” the phrase “subject to credit approval”, <span class="math inline">\(80\%\)</span> of non-spam messages contain neither the word “free” nor the phrase “subject to credit approval”. Randomly select an incoming email message. Let <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> represent the following events: <span class="math display">\[\begin{align*}
A &amp;= \text{email is spam (i.e., junk mail)}, \\
B &amp;= \text{email contains the word ``free''}, \\
C &amp;= \text{email contains the phrase ``subject to credit approval''}.
\end{align*}\]</span></p>
<p><strong>a)</strong> Consider the event that the randomly selected incoming email message is spam but does not include the word “free”, nor the phrase “subject to credit approval”. Answer parts (i)-(iii) based on this event.<br>
(i) Write this event down in the appropriate set notation: (ii) Draw a Venn Diagram of this sample space and shade in this event.<br>
(iii) Compute the probability of this event and list any probability rules/principles that you apply.</p>
<p><strong>b)</strong> What is the probability that a randomly selected email message is spam given it does not include the word “free”, nor the phrase “subject to credit approval”?</p>
</section>
<section id="question-4-1" class="level2 callout-question" data-collapse="true">
<h2 class="anchored" data-anchor-id="question-4-1">Question 4</h2>
<p>You are trying to pull an all-nighter to study the night before an exam (<strong>don’t do this for STA237H1</strong>!). There are 10 more hours until your exam. The amount of time, in hours, that you can stay awake to study for can be modeled by a random variable <span class="math inline">\(X\)</span> with PDF <span class="math display">\[
f(x) =
\begin{cases}
ce^{-0.25(x - 2)}, &amp; 2 &lt; x &lt; 10 \\
0, &amp; \text{otherwise}
\end{cases}
\]</span> where <span class="math inline">\(c\)</span> is a constant.</p>
<ol type="a">
<li>What is the constant <span class="math inline">\(c\)</span> that makes this a valid PDF?</li>
<li>You know you need <span class="math inline">\(4\)</span> hours to go over enough material to pass your exam, and otherwise, you will fail. What is the probability that you pass your exam? Sketch the PDF, mark this probability on your plot, and compute this probability.</li>
<li>What is the probability that you study for exactly <span class="math inline">\(5\)</span> hours? Sketch the PDF again and mark this probability on your plot.</li>
<li>You find out that your exam is entirely multiple choice, and if you study for less than <span class="math inline">\(4\)</span> hours, there is a <span class="math inline">\(30\%\)</span> probability that you will pass your exam by randomly guessing the answers. If you study for more than <span class="math inline">\(4\)</span> hours, you will pass for sure. What is the probability that you will pass the exam now? Compute the probability of this event and list any probability rules/principles that you apply.</li>
</ol>
</section>
</section>
<section id="week-5" class="level1">
<h1>Week 5</h1>
<section id="question-1-4" class="level2 callout-question" data-collapse="true">
<h2 class="anchored" data-anchor-id="question-1-4">Question 1</h2>
<p>Suppose <span class="math inline">\(Y\)</span> has pdf <span class="math display">\[f_Y(y) =
\begin{cases}
c(2 - y), &amp; 0 \leq y \leq 2 \\
0, &amp; \text{otherwise}
\end{cases}\]</span></p>
<p>For this distribution, find each of the following. Be sure to show your steps.</p>
<p><strong>a)</strong> <span class="math inline">\(c\)</span></p>
<p><strong>b)</strong> <span class="math inline">\(F_Y(y)\)</span></p>
<p><strong>c)</strong> <span class="math inline">\(\mathbb{P}(1 &lt; Y \leq 2)\)</span></p>
<p><strong>d)</strong> The expected value and variance of a continuous random variable can be determined using its pdf, similar to how we used pmfs for discrete random variables; now instead of summing, we integrate.</p>
<ol type="i">
<li><span class="math inline">\(E(Y) = \int_{-\infty}^{\infty} y f_Y(y) \, dy\)</span></li>
<li><span class="math inline">\(V(Y) = \int_{-\infty}^{\infty} [y - E(Y)]^2 f_Y(y) \, dy\)</span></li>
</ol>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> Using the fact that the total area under the curve of a valid pdf must be <span class="math inline">\(1\)</span>, we have do the following</p>
<p><span class="math display">\[\begin{align*}
c \int_0^2 (2 - y) \, dy &amp;= 1 \\
c \left[ 2y - \frac{y^2}{2} \right]_0^2 &amp;= 1 \\
c \left( 2(2) - \frac{2^2}{2} \right) &amp;= 1 \\
c(4 - 2) &amp;= 1 \\
2c &amp;= 1 \\
\Rightarrow \boxed{c = \frac{1}{2}}
\end{align*}\]</span></p>
<hr>
<p><strong>b)</strong> We find the cdf by integrating the pdf:</p>
<p><span class="math display">\[\boxed{
F_Y(y) =
\begin{cases}
0, &amp; y &lt; 0 \\[6pt]
\displaystyle \int_0^y \frac{1}{2}(2 - t) \, dt = y - \dfrac{y^2}{4}, &amp; 0 \leq y \leq 2 \\[6pt]
1, &amp; y &gt; 2
\end{cases}}
\]</span></p>
<hr>
<p><strong>c)</strong> Since <span class="math display">\[\mathbb{P}(1 &lt; Y \leq 2) = F_Y(2) - F_Y(1)\]</span> So then from part b, we can compute</p>
<p><span class="math display">\[\begin{align*}
F_Y(2) &amp;= 2 - \frac{2^2}{4} = 2 - 1 = 1 \\
F_Y(1) &amp;= 1 - \frac{1^2}{4} = 1 - \frac{1}{4} = \frac{3}{4}
\end{align*}\]</span></p>
<p>Thus, <span class="math display">\[\mathbb{P}(1 &lt; Y \leq 2) = 1 - \frac{3}{4} = \boxed{\frac{1}{4}}\]</span></p>
<hr>
<p><strong>d)</strong></p>
<ol type="i">
<li>We compute the mean of <span class="math inline">\(Y\)</span> from the definition,</li>
</ol>
<p><span class="math display">\[\begin{align*}
\mu = \mathbb{E}(Y)
&amp;= \int_0^2 y \cdot \frac{1}{2}(2 - y) \, dy \\
&amp;= \frac{1}{2} \int_0^2 y(2 - y) \, dy \\
&amp;= \frac{1}{2} \int_0^2 (2y - y^2) \, dy \\
&amp;= \frac{1}{2} \left[ y^2 - \frac{y^3}{3} \right]_0^2 \\
&amp;= \frac{1}{2} \left( 4 - \frac{8}{3} \right) \\
&amp;= \frac{1}{2} \cdot \frac{4}{3} = \boxed{\frac{2}{3}}
\end{align*}\]</span></p>
<ol start="2" type="i">
<li>Like in the discrete case, we can express the variance <span class="math inline">\(\mathbb{V}(Y) = \mathbb{E}(Y^2) - \left( \mathbb{E}(Y) \right)^2\)</span>.So first, we get</li>
</ol>
<p><span class="math display">\[\begin{align*}
\mathbb{E}(Y^2)
&amp;= \int_0^2 y^2 \cdot \frac{1}{2}(2 - y) \, dy \\
&amp;= \frac{1}{2} \int_0^2 (2y^2 - y^3) \, dy \\
&amp;= \frac{1}{2} \left[ \frac{2y^3}{3} - \frac{y^4}{4} \right]_0^2 \\
&amp;= \frac{1}{2} \left( \frac{16}{3} - \frac{16}{4} \right) \\
&amp;= \frac{1}{2} \left( \frac{16}{3} - 4 \right) = \frac{1}{2} \cdot \frac{4}{3} = \boxed{\frac{2}{3}}
\end{align*}\]</span></p>
<p>Then, <span class="math display">\[\begin{align*}
\sigma^2 = \mathbb{V}(Y)
&amp;= \mathbb{E}(Y^2) - \left( \mathbb{E}(Y) \right)^2 \\
&amp;= \frac{2}{3} - \left( \frac{2}{3} \right)^2 \\
&amp;= \frac{2}{3} - \frac{4}{9} = \boxed{\frac{2}{9}}
\end{align*}\]</span></p>
</div>
</div>
</div>
<section id="question-2-4" class="level2 callout-question" data-collapse="true">
<h2 class="anchored" data-anchor-id="question-2-4">Question 2</h2>
<p>Consider the continuous random variable <span class="math inline">\(X\)</span> with pdf given by</p>
<p><span class="math display">\[
f_X(x) =
\begin{cases}
2e^{-2x}, &amp; x \geq 0 \\
0, &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p><strong>a)</strong> What is the cdf of <span class="math inline">\(X\)</span>?</p>
<p><strong>b)</strong> Find <span class="math inline">\(E(X)\)</span>. Be sure to show your steps.</p>
<p><strong>c)</strong> Determine <span class="math inline">\(F^{-1}(U)\)</span> and use R to simulate 10,000 observations from this pdf by the inverse transform method. Note that the <em>runif(n, min = a, max = b)</em> R function can be used to simulate <span class="math inline">\(n\)</span> realizations of a <span class="math inline">\(Unif(a, b)\)</span> random variable.</p>
<p><strong>d)</strong> Compute the mean of the generated observations and compare the result with <span class="math inline">\(E(X)\)</span> that was obtained in part (b).</p>
</section>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>a)</strong> We need to integrate the pdf to get the final answer</p>
<p><span class="math display">\[\boxed{
F_X(x) =
\begin{cases}
0, &amp; x &lt; 0 \\[6pt]
1 - e^{-2x}, &amp; x \geq 0
\end{cases}
}\]</span></p>
<hr>
<p><strong>b)</strong> We use the definition of the expected value</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}(X) &amp;= \int_{0}^{\infty} x \cdot 2e^{-2x} \, dx
\end{align*}\]</span></p>
<p>Use integration by parts:</p>
<p>Let <span class="math inline">\(u = x\)</span>, <span class="math inline">\(dv = 2e^{-2x}dx\)</span><br>
Then <span class="math inline">\(du = dx\)</span>, <span class="math inline">\(v = -e^{-2x}\)</span></p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}(X) &amp;= \left[ -x e^{-2x} \right]_0^\infty + \int_0^\infty e^{-2x} \, dx \\
&amp;= 0 + \left[ -\frac{1}{2} e^{-2x} \right]_0^\infty \\
&amp;= \boxed{\frac{1}{2}}
\end{align*}\]</span></p>
<hr>
<p><strong>c)</strong></p>
<p>From part a, we found that <span class="math display">\[F_X(x) = 1 - e^{-2x}, \quad x \geq 0\]</span></p>
<p>Let ( U (0, 1) ), and solve: <span class="math display">\[\begin{align*}
U &amp;= 1 - e^{-2x} \\
e^{-2x} &amp;= 1 - U \\
-2x &amp;= \ln(1 - U) \\
x &amp;= -\frac{1}{2} \ln(1 - U)
\end{align*}\]</span></p>
<p>So the inverse cdf is <span class="math inline">\(F_X^{-1}(U) = -\frac{1}{2} \ln(1 - U)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse transform sampling</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u) <span class="sc">/</span> lambda</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histogram with density overlay</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"x"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram of Simulated X Values (Inverse Transform)"</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay true exponential density for comparison</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dexp</span>(x, <span class="at">rate =</span> lambda), <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"True density exp(2)"</span>), <span class="at">col =</span> <span class="st">"darkred"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong>d)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5003358</code></pre>
</div>
</div>
<p>Note that this (ie. the expected value calculated using the Inverse Transform Method) is very close to the theoretical mean of the exponential distribution in part b.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Note: Inverse Transform Method</strong>. In part c, we’ve learned how to simulate random values from a specific distribution using just uniform random numbers (which computers are really good at generating).</p>
<p>Since we want values from an Exponential distribution, and we already know its cdf, we can work backwards to get a formula that tells us how to turn a Uniform(0,1) value into an Exponential one. This is the <a href="https://en.wikipedia.org/wiki/Inverse_transform_sampling">inverse transform method</a>.</p>
<p>This is indeed how R’s built-in function <em>rexp()</em> (and for many other distributions) work under the hood.</p>
</div>
</div>
</section>
<section id="week-6" class="level1">
<h1>Week 6</h1>
<p>A continuous random variable <span class="math inline">\(X\)</span> is said to have a pareto distribution with location parameter <span class="math inline">\(m\)</span> and shape parameter <span class="math inline">\(a\)</span>, if its probability density function is of the form <span class="math display">\[f(x) = \frac{a m^a}{x^{a+1}}, \quad \text{for } x \geq m\]</span> and zero if <span class="math inline">\(x &lt; m\)</span>.</p>
<p>Vilfredo Pareto originally used this distribution to describe the allocation of wealth among individuals since it seemed to show rather well the way that a larger portion of the wealth of any society is owned by a smaller percentage of the people in that society. He also used it to describe distribution of income. This idea is sometimes expressed more simply as the Pareto principle or the “80-20 rule” which says that <span class="math inline">\(20\%\)</span> of the population controls <span class="math inline">\(80\%\)</span> of the wealth. Today, the Pareto distribution is often used to model catastrophic events where a claim might have a very large value (e.g., extreme weather events, war, etc.). We denote it as <span class="math inline">\(X \sim \text{Par}(m, a)\)</span>, where <span class="math inline">\(m, a &gt; 0\)</span>.</p>
<p>This distribution is right-skewed, and it is characterized by its heavy long tail. One way to plot this pdf in R is given by the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("EnvStats") </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span>; m<span class="ot">&lt;-</span><span class="dv">1</span>; a<span class="ot">&lt;-</span><span class="fl">0.5</span> <span class="co"># location=1 &amp; shape=0.5 </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="at">length=</span>n) <span class="co"># equally-spaced sequence from 1 to 20 </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">dpareto</span>(x,m,a) </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">"l"</span>) </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># adds dotted line at y=0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are no built-in pareto distribution functions in base R, so we need to first install and load R package <em>EnvStats</em> to use the functions <em>dpareto()</em>, <em>ppareto()</em>, <em>qpareto()</em> and <em>rpareto()</em>. In these functions, the location (m) and shape (a) parameters should be entered as the second and third arguments, respectively, unless you name them (i.e., define location=, and shape= in the inputs).</p>
<p>The mean and variance diverge if parameter α is not large enough. In particular, the mean is <span class="math display">\[\mu = E(X) = \frac{am}{a - 1} \quad \text{if } a &gt; 1\]</span></p>
<p>and the variance is<br>
<span class="math display">\[\sigma^2 = \mathrm{Var}(X) = \frac{am^2}{(a - 1)^2 (a - 2)} \quad \text{if } a &gt; 2\]</span> If <span class="math inline">\(a \le 1\)</span> the mean is infinity (diverges) and if <span class="math inline">\(a \le 2\)</span> the variance is infinity (diverges). For this reason, the moment generating function does not exist.</p>
<p>The cumulative distribution function is given in closed form <span class="math display">\[F(x) = 1 - \left( \frac{m}{x} \right)^a \quad \text{for } x \geq m\]</span></p>
<p>and zero otherwise.</p>
<p>The p-th quantile (or 100p-th percentile), denoted as <span class="math inline">\(x_p\)</span> is given by <span class="math display">\[x_p = m(1 - p)^{-\frac{1}{a}}\]</span></p>
<div class="callout-question" data-collapse="true">
<section id="question-1-5" class="level2">
<h2 class="anchored" data-anchor-id="question-1-5">Question 1</h2>
<p>Prove that when <span class="math inline">\(a = m = 1\)</span>, then <span class="math inline">\(\mathbb{E}(X)\)</span> does not exist (it diverges to infinity).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By definition, <span class="math display">\[E(X) = \int_1^{\infty} x \cdot \frac{1}{x^2} \, dx = \int_1^{\infty} \frac{1}{x} \, dx = \log(x)\big|_1^{\infty} = \lim_{n \to \infty} \log(x) - \log(1) = \infty - 0 = \infty
\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-2-5" class="level2">
<h2 class="anchored" data-anchor-id="question-2-5">Question 2</h2>
<p>For <span class="math inline">\(a = m = 1\)</span>, obtain the pth quantiles where <span class="math inline">\(p = 0.5, 0.75, 0.9, 0.95, 0.99\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using the formula <span class="math inline">\(x_p = \frac{1}{1 - p}\)</span>, we plug in and see that <span class="math display">\[x_{0.5} = 2,\ x_{0.75} = 4,\ x = 2,\ x_{0.95} = 20,\ x_{0.99} = 100\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-3-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3-3">Question 3</h2>
<p>Sample <span class="math inline">\(n=100\)</span> random values from a Pareto distribution with parameters <span class="math inline">\(a = 0.5\)</span> and <span class="math inline">\(m=1\)</span>. Plot a histogram of the simulated values and use them to compute the sample mean and variance of the <span class="math inline">\(100\)</span> values. Compare the sample mean and sample variance with the theoretical values. Is this a good approximation of the theoretical mean and variance? If not, how could it be improved?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rpareto</span>(n,m,a) </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="STA237-Summer-2025_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2885.227</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 483067593</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(a &lt; 1\)</span>, the mean and variance are both infinity. So the estimated mean and variance will not match their theoretical counterparts.</p>
<p>The issue lies within having too small of an <span class="math inline">\(a\)</span>, leading the distribution to be heavily left-skewed. For the estimation to be more accurate, we need a larger <span class="math inline">\(a\)</span> (e.g.&nbsp;<span class="math inline">\(a &gt; 2\)</span>). Note that increasing sample size won’t help much in this case, since the mean and variance are infinity.</p>
</div>
</div>
</div>
</section>
<section id="question-4-2" class="level2">
<h2 class="anchored" data-anchor-id="question-4-2">Question 4</h2>
<p>In a population, suppose personal income above <span class="math inline">\(\$22,000\)</span> has a Pareto distribution with <span class="math inline">\(a = 2.8\)</span> (units are <span class="math inline">\(\$10,000\)</span>). Find the probability that a randomly chosen individual’s income is greater than <span class="math inline">\(4\)</span> standard deviations above the mean.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first find the mean and variance <span class="math display">\[\mu = \frac{a m}{a - 1} = \frac{2.8 \times 2.2}{2.8 - 1}  \approx 3.422\]</span></p>
<p><span class="math display">\[\sigma^2 = \frac{a m^2}{(a - 1)^2 (a - 2)}
= \frac{2.8 \times 2.2^2}{(2.8 - 1)^2 \times (2.8-2)}
\approx 5.2284 \implies \sigma \approx \sqrt{5.2284} \approx 2.287\]</span></p>
<p>Next, we compute the threshold (here <span class="math inline">\(k = 4\)</span>) <span class="math display">\[\mu + 4\sigma \approx 3.422 + 4 \times 2.287 = 12.57\]</span> Lastly, we use the Pareto cdf to compute the probability <span class="math display">\[P(X &gt; x) = \left( \frac{m}{x} \right)^a
\Rightarrow P(X &gt; 12.57) = \left( \frac{2.2}{12.57} \right)^{2.8} \approx \boxed{0.0076}\]</span></p>
<p>In, R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppareto</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fl">5.228395</span>)<span class="sc">+</span><span class="fl">3.422222</span>, <span class="at">location=</span><span class="fl">2.2</span>, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="at">shape=</span><span class="fl">2.8</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007599592</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>The aggregate losses on an auto insurance policy follow a Pareto distribution with <span class="math inline">\(a = 4\)</span> and <span class="math inline">\(m = 800\)</span>. What’s the probability that the aggregate losses on a random policy exceed <span class="math inline">\(\$1000\)</span>?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X\)</span> denote the aggregate losses on an auto insurance, so <span class="math inline">\(X \sim \text{Par}(m = 800, a = 4)\)</span>.</p>
<p>Then <span class="math display">\[P(X &gt; 1000) = \left( \frac{800}{1000} \right)^4 = 0.4096\]</span></p>
<p>In R,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppareto</span>(<span class="dv">1000</span>,<span class="dv">800</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4096</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>Suppose the income of a certain population has a Pareto distribution with <span class="math inline">\(a=3\)</span> and <span class="math inline">\(m=1000\)</span>. What is the proportion of the population with incomes between <span class="math inline">\(2000\)</span> and <span class="math inline">\(4000\)</span>?</p>
</section>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X\)</span> denote the income of a certain population. It follows that <span class="math inline">\(X \text{Par}(1000, 3)\)</span>.</p>
<p>The desired proportion is given by</p>
<p><span class="math display">\[P(2000 &lt; X &lt; 4000) = F(4000) - F(2000) = \left( \frac{1000}{2000} \right)^3 - \left( \frac{1000}{4000} \right)^3 = 0.1094\]</span></p>
<p>In R,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppareto</span>(<span class="dv">4000</span>,<span class="dv">1000</span>,<span class="dv">3</span>)<span class="sc">-</span><span class="fu">ppareto</span>(<span class="dv">2000</span>,<span class="dv">1000</span>,<span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.109375</code></pre>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/johnyzyfei\.github\.io\/zhengyang-fei\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Zhengyang Fei, University of Toronto @ 2025</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>